<!doctype html> <html lang=en> <head> <meta charset=utf-8> <meta content="width=device-width,initial-scale=1" name=viewport> <meta content=#333333 name=theme-color> <script src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js async data-ad-client=ca-pub-1501125542619304></script> <base href=/ > <link href=global.css rel=stylesheet> <link href=manifest.json rel=manifest crossorigin=use-credentials> <link href=favicon.png rel=icon type=image/png> <link href=client/main.2661290277.css rel=stylesheet> <noscript id=sapper-head-start></noscript><title>Creating a Simple Discord Bot.</title><script data-svelte=svelte-kjauiq src="https://www.googletagmanager.com/gtag/js?id=G-TJ8JZX38E6" async></script><script data-svelte=svelte-kjauiq>window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'G-TJ8JZX38E6'); </script><script data-svelte=svelte-kjauiq src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js async></script><script data-svelte=svelte-kjauiq>(adsbygoogle = window.adsbygoogle || []).push({
			google_ad_client: "ca-pub-1501125542619304",
			enable_page_level_ads: true
		}); </script><script data-svelte=svelte-kjauiq src=https://platform.twitter.com/widgets.js id=twitter-wjs></script><link href=./photoswipe/photoswipe.css rel=stylesheet data-svelte=svelte-kjauiq><link href=./photoswipe/default-skin/default-skin.css rel=stylesheet data-svelte=svelte-kjauiq><script data-svelte=svelte-kjauiq src=./photoswipe/photoswipe.min.js></script><script data-svelte=svelte-kjauiq src=./photoswipe/photoswipe-ui-default.min.js></script><meta content=summary data-svelte=svelte-btz695 name=twitter:card><meta content=@joshglasson data-svelte=svelte-btz695 name=twitter:site><meta content=@joshglasson data-svelte=svelte-btz695 name=twitter:creator><meta content="Creating a Simple Discord Bot." data-svelte=svelte-btz695 property=og:title><meta content=https://joshglasson.com/images/icons/discord%20logo.png data-svelte=svelte-btz695 property=og:image><meta content="Its not self promotion if its done by a robot!" data-svelte=svelte-btz695 property=og:description><meta content=https://joshglasson.com/blog/discord_bot data-svelte=svelte-btz695 property=og:url><noscript id=sapper-head-end></noscript> </head> <body> <div id=sapper> <nav class=svelte-gj03cv id=navbar><ul class=svelte-gj03cv><li class=svelte-gj03cv><a href=home class=svelte-gj03cv>home</a></li> <li class=svelte-gj03cv><a href=about class=svelte-gj03cv>about</a></li> <li class=svelte-gj03cv><a href=blog class=svelte-gj03cv aria-current=blog rel=prefetch>blog</a></li> <li class=svelte-gj03cv><a class=svelte-gj03cv>dark mode</a></ul></nav> <main class=svelte-u6q2x9> <div class="svelte-esspr7 postTitle"><h1 class=svelte-esspr7>Creating a Simple Discord Bot.</h1> <h2 class=svelte-esspr7><strong>Its not self promotion if its done by a robot!</strong></h2></div> <div class="svelte-esspr7 date"><h3><i>Originally posted on Wed Sep 02 2020</i></h3></div> <div class="svelte-esspr7 readTime"></div> <div class="svelte-esspr7 content"><p>I was sitting at home yesterday thinking it would be good to work on something small just for some practice. I stumbled upon a <a href=https://www.maxbits.net/blog/post/Writing-a-Discord-Bot-in-Ruby-using-DiscordRB/ target=_blank>blog post</a> regarding making a discord bot, and decided it would be cool to give it a go.</p> <p>The blog shows the process using Ruby. I hadn't used Ruby for a while so it wasn't easy for me to pick it up and remember the syntax. For that reason I decided I would also do it in JavaScript as I know more about it. I found a guide <a href=https://www.sitepoint.com/discord-bot-node-js/ target=_blank>here</a> which was really helpful.</p> <br> <h1 id=ruby>Ruby</h1> <p>So as I mentioned above, I pretty much followed the blog I linked, with only a few minor changes to get things working, and instead of just sending a test message I wanted to send a link to my blog. I will go through the steps from the start, but credit to the above blog for most of the work!</p> <h2 id=register-your-bot>Register Your Bot</h2> <p>To start with, you need to create a new Application in the <a href=https://discord.com/developers/applications target=_blank>Discord Develper Portal</a>, which you can call whatever you want. I gave it the same name I wanted to give my bot, just to make life easier! Once you have a new application, go to the Bot tab, and press Add Bot. We will need its token and client id soon.</p> <div id=imageDiv> <figure> <img alt="Creating a New Application" src=https://joshlearningtocode.files.wordpress.com/2020/09/discord-bot-new-application.png> <figcaption>Creating a New Application</figcaption> </figure> </div> <h2 id=project-setup>Project Setup</h2> <p>In your IDE of choice, create a project with the following structure.</p> <div id=imageDiv> <figure> <img alt="Project Structure" src=https://joshlearningtocode.files.wordpress.com/2020/09/discord-bot-project-structure.png> <figcaption>Project Structure</figcaption> </figure> </div> <p>If you haven't used Ruby before, the <code>Gemfile</code> is used to define dependencies. So starting with the <code>Gemfile</code>, the first thing we need to do is get the <code>discordrb</code> gem, so add the below to your <code>Gemfile</code>:</p> <div id=codeSnippet> <pre class=language-javascriptreact><code>source <span class=hljs-string>'https://rubygems.org'</span>
gem <span class=hljs-string>'discordrb'</span></code></pre></div> <p>In the post I followed they did not define a <code>source</code>, however I needed it to make this work. To install the dependency, run <code>bundle install</code>. You should have <code>Bundler</code> installed already if you have Ruby. If not, now would be a good time to install Ruby!</p> <p>Next, we can put the below into <code>run.rb</code>:</p> <div id=codeSnippet> <pre class=language-javascriptreact><code>require_relative <span class=hljs-string>'src/bot'</span></code></pre></div> <p><code>run.rb</code> is acting a shortcut to the <code>bot.rb</code> file where we are actually going to run our code. So lets give it some code to run, in <code>src/bot.rb</code> add:</p> <div id=codeSnippet> <pre class=language-javascriptreact><code><span class=hljs-keyword>require</span> <span class=hljs-string>'discordrb'</span>
<span class=hljs-keyword>require</span> <span class=hljs-string>'ostruct'</span>
<span class=hljs-keyword>require</span> <span class=hljs-string>'yaml'</span>

<span class=hljs-class><span class=hljs-keyword>module</span> <span class=hljs-title>Bot</span></span>
    <span class=hljs-keyword>if</span> File.file? <span class=hljs-string>'data/config.yaml'</span>
        CONFIG = OpenStruct.new YAML.load_file <span class=hljs-string>'data/config.yaml'</span>
    <span class=hljs-keyword>else</span>
        puts <span class=hljs-string>'Can\'t load config file!'</span>
        exit!
    <span class=hljs-keyword>end</span>

    BOT = Discordrb::Commands::CommandBot.new(<span class=hljs-symbol>client_id:</span> CONFIG.client_id, <span class=hljs-symbol>token:</span> CONFIG.token, <span class=hljs-symbol>prefix:</span> CONFIG.prefix)

    <span class=hljs-comment># Discord Commands</span>
    <span class=hljs-class><span class=hljs-keyword>module</span> <span class=hljs-title>DiscordCommands</span>;</span> <span class=hljs-keyword>end</span>
    Dir[<span class=hljs-string>'src/modules/commands/*.rb'</span>].each { <span class=hljs-params>|mod|</span> load mod }
    DiscordCommands.constants.each <span class=hljs-keyword>do</span> <span class=hljs-params>|mod|</span>
        BOT.<span class=hljs-keyword>include</span>! DiscordCommands.const_get mod
    <span class=hljs-keyword>end</span>

    <span class=hljs-comment># Discord Events</span>
    <span class=hljs-class><span class=hljs-keyword>module</span> <span class=hljs-title>DiscordEvents</span>;</span> <span class=hljs-keyword>end</span>
    Dir[<span class=hljs-string>'src/modules/events/*.rb'</span>].each { <span class=hljs-params>|mod|</span> load mod }
    DiscordEvents.constants.each <span class=hljs-keyword>do</span> <span class=hljs-params>|mod|</span>
        BOT.<span class=hljs-keyword>include</span>! DiscordEvents.const_get mod
    <span class=hljs-keyword>end</span>

    BOT.run
<span class=hljs-keyword>end</span></code></pre></div> <p>The blog post I followed gives some good descriptions of what each part of this code is doing, so probably worth checking that out.</p> <p>You can see in the code above, we are getting some information from <code>CONFIG</code>. This is coming from the <code>data/config.yaml</code> file, which has three properties in it:</p> <div id=codeSnippet> <pre class=language-javascriptreact><code><span class=hljs-symbol>client_id:</span> <span class=hljs-string>'Client Id (From the Dev Portal)'</span>
<span class=hljs-symbol>token:</span> <span class=hljs-string>'Your Token (From the Dev Portal)'</span>
<span class=hljs-symbol>prefix:</span> <span class=hljs-string>'?'</span></code></pre></div> <p>The client id and token both come from the Bot tab in the Discord Dev Portal. The prefix can be whatever you want, and will be used to call your bot with commands.</p> <p>Now that's all set up we can actually give it a command to work with. The post I followed gave a simple example of sending <code>?ping</code> and the bot responding with <em>pong</em>. However that isn't very interesting, so I am branching off here for a moment! I wanted my bot to promote my blog, by sending a link to it in the chat. So in <code>src/modules/commands/</code> I added a file called <code>promote.rb</code>, in which I added the following code:</p> <div id=codeSnippet> <pre class=language-javascriptreact><code><span class=hljs-keyword>require</span> <span class=hljs-string>'discordrb/webhooks'</span>

<span class=hljs-class><span class=hljs-keyword>module</span> <span class=hljs-title>Bot</span></span>
    <span class=hljs-class><span class=hljs-keyword>module</span> <span class=hljs-title>DiscordCommands</span></span>
        <span class=hljs-class><span class=hljs-keyword>module</span> <span class=hljs-title>Promote</span> <span class=hljs-title>extend</span> <span class=hljs-title>Discordrb::Commands::CommandContainer</span></span>
            command <span class=hljs-symbol>:promote</span> <span class=hljs-keyword>do</span> <span class=hljs-params>|event|</span>
                event.channel.send_embed(<span class=hljs-string>"Check out my blog here: "</span>) <span class=hljs-keyword>do</span> <span class=hljs-params>|embed|</span>
                    embed.title = <span class=hljs-string>"Joshs Blog"</span>
                    embed.colour = Random.bytes(<span class=hljs-number>3</span>).unpack1(<span class=hljs-string>'H*'</span>)
                    embed.url = <span class=hljs-string>"https://joshglasson.com"</span>
                    embed.description = <span class=hljs-string>"My personal blog about Software Development, Sports, Music, and any more of my hobbies!"</span>
                    embed.timestamp = Time.at(Time.now())
                <span class=hljs-keyword>end</span>
            <span class=hljs-keyword>end</span>
        <span class=hljs-keyword>end</span>
    <span class=hljs-keyword>end</span>
<span class=hljs-keyword>end</span></code></pre></div> <p>Theres two parts to this to explain really. Firstly:</p> <div id=codeSnippet> <pre class=language-javascriptreact><code><span class=hljs-class><span class=hljs-keyword>module</span> <span class=hljs-title>Bot</span></span>
    <span class=hljs-class><span class=hljs-keyword>module</span> <span class=hljs-title>DiscordCommands</span></span>
        <span class=hljs-class><span class=hljs-keyword>module</span> <span class=hljs-title>Promote</span> <span class=hljs-title>extend</span> <span class=hljs-title>Discordrb::Commands::CommandContainer</span></span>
            command <span class=hljs-symbol>:promote</span> <span class=hljs-keyword>do</span> <span class=hljs-params>|event|</span>
              <span class=hljs-comment># not important right now</span>
            <span class=hljs-keyword>end</span>
        <span class=hljs-keyword>end</span>
    <span class=hljs-keyword>end</span>
<span class=hljs-keyword>end</span></code></pre></div> <p>This is the code to handle commands. We have extended <code>Discordrb::Commands::CommandContainer</code> which comes from the <code>discordrb</code> plugin, and added code in to handle commands. In this case, <code>command :promote do |event|</code> will listen for a <code>promote</code> command, and do something if it receives it.</p> <div id=codeSnippet> <pre class=language-javascriptreact><code><span class=hljs-keyword>require</span> <span class=hljs-string>'discordrb/webhooks'</span>

command <span class=hljs-symbol>:promote</span> <span class=hljs-keyword>do</span> <span class=hljs-params>|event|</span>
    event.channel.send_embed(<span class=hljs-string>"Check out my blog here: "</span>) <span class=hljs-keyword>do</span> <span class=hljs-params>|embed|</span>
        embed.title = <span class=hljs-string>"Joshs Blog"</span>
        embed.colour = Random.bytes(<span class=hljs-number>3</span>).unpack1(<span class=hljs-string>'H*'</span>)
        embed.url = <span class=hljs-string>"https://joshglasson.com"</span>
        embed.description = <span class=hljs-string>"My personal blog about Software Development, Sports, Music, and any more of my hobbies!"</span>
        embed.timestamp = Time.at(Time.now())
    <span class=hljs-keyword>end</span>
<span class=hljs-keyword>end</span></code></pre></div> <p>Inside the command block is some code to embed a link. To use this we have to import <code>discordrb/webhooks</code>. Then we can use that to send an embedded link to the channel. I used the <a href=https://leovoel.github.io/embed-visualizer/ target=_blank>Discord Embed Visualiser</a> to help me build the code.</p> <div id=imageDiv> <figure> <img alt="Ruby Code to Embed a Link" src=https://joshlearningtocode.files.wordpress.com/2020/09/discord-bot-ruby-embed.png> <figcaption>Ruby Code to Embed a Link</figcaption> </figure> </div> <p>I replaced the colour with some code that randomly generates a hex code instead, and the hardcoded timestamp with a dynamic time instead.</p> <p>The last part is the same as the original post. In <code>events/online.rb</code> we add the following code:</p> <div id=codeSnippet> <pre class=language-javascriptreact><code><span class=hljs-class><span class=hljs-keyword>module</span> <span class=hljs-title>Bot</span></span>
    <span class=hljs-class><span class=hljs-keyword>module</span> <span class=hljs-title>DiscordEvents</span></span>
        <span class=hljs-class><span class=hljs-keyword>module</span> <span class=hljs-title>Online</span> <span class=hljs-title>extend</span> <span class=hljs-title>Discordrb::EventContainer</span></span>
            ready <span class=hljs-keyword>do</span> <span class=hljs-params>|event|</span>
                puts <span class=hljs-string>"Logged in as <span class=hljs-subst>#{event.bot.profile.distinct}</span>"</span>
                puts <span class=hljs-string>"Invite URL: <span class=hljs-subst>#{event.bot.invite_url}</span>"</span>
            <span class=hljs-keyword>end</span>
        <span class=hljs-keyword>end</span>
    <span class=hljs-keyword>end</span>
<span class=hljs-keyword>end</span></code></pre></div> <p>Upon running <code>ruby run.rb</code>, you should see a message like this:</p> <div id=codeSnippet> <pre class=language-javascriptreact><code>[INFO : websocket @ 2020-09-02 09:25:30.187] Discord using gateway protocol version: 6, requested: 6
Logged <span class=hljs-keyword>in</span> as JoshsBlogPromoter<span class=hljs-comment>#0931</span>
Invite URL: https://discordapp.com/oauth2/authorize?&client_id=750398124148654120&scope=bot</code></pre></div> <p>If you follow the link, it should give you the option of adding the bot to one of your discord servers. Now you can test it by sending it a message, in this case <code>?promote</code>:</p> <div id=imageDiv> <figure> <img alt="Ruby Bot Working in Discord" src=https://joshlearningtocode.files.wordpress.com/2020/09/discord-bot-ruby-message.png> <figcaption>Ruby Bot Working in Discord</figcaption> </figure> </div> <br> <h1 id=javascript>JavaScript</h1> <p>So now we have a Ruby Discord Bot working, lets make one in JavaScript.</p> <h2 id=bot-setup>Bot Setup</h2> <p>Firstly if you did not create an Application and Bot in the Ruby guide, do so now. Once that is done, go to the <strong>OAuth2</strong> tab and setup the permissions you want your bot to have. In <strong><em>Scopes</em></strong> tick <em>bot</em>, and in <strong><em>Bot Permissions</em></strong> I have ticked <em>Send Messages</em> and <em>Read Message History</em>. If you want it to do more, of course you can tick more options. Doing this should update the link in <strong><em>Scopes</em></strong>, and once you are happy, copy this link into your browser. This should take you to a page to add your bot to your server.</p> <h2 id=project-setup-1>Project Setup</h2> <p>To start with, create 2 files. Firstly create a <code>package.json</code> file with the below:</p> <div id=codeSnippet> <pre class=language-javascriptreact><code>{
  <span class=hljs-attr>"name"</span>: <span class=hljs-string>"discord-bot"</span>,
  <span class=hljs-attr>"version"</span>: <span class=hljs-string>"1.0.0"</span>,
  <span class=hljs-attr>"description"</span>: <span class=hljs-string>"My Discord Bot"</span>,
  <span class=hljs-attr>"main"</span>: <span class=hljs-string>"index.js"</span>,
  <span class=hljs-attr>"scripts"</span>: {
    <span class=hljs-attr>"test"</span>: <span class=hljs-string>"echo \"Error: no test specified\" && exit 1"</span>
  },
  <span class=hljs-attr>"author"</span>: <span class=hljs-string>"Josh Glasson"</span>,
  <span class=hljs-attr>"license"</span>: <span class=hljs-string>"ISC"</span>,
  <span class=hljs-attr>"dependencies"</span>: {
    <span class=hljs-attr>"discord.js"</span>: <span class=hljs-string>"^11.5.1"</span>,
    <span class=hljs-attr>"dotenv"</span>: <span class=hljs-string>"^8.2.0"</span>
  }
}</code></pre></div> <p>Then run <code>npm install</code> to install the two defined dependencies, <code>discord.js</code> and <code>dotenv</code>. <code>dotenv</code> is going to help us keep our token private.</p> <p>Next create a file called <code>.env</code> and add your token into it:</p> <div id=codeSnippet> <pre class=language-javascriptreact><code><span class=hljs-string>TOKEN='Your</span> <span class=hljs-string>Token'</span></code></pre></div> <p>I would create a <code>.gitignore</code> file now too and make sure to add <code>.env</code> to it, just so you don't forget!</p> <p>Now we can create the bot. You may have noticed in the <code>package.json</code> file we defined <code>main</code> as <code>index.js</code>. That is the entrypoint for npm, so we should create an <code>index.js</code>.</p> <div id=codeSnippet> <pre class=language-javascriptreact><code><span class=hljs-built_in>require</span>(<span class=hljs-string>'dotenv'</span>).config();
<span class=hljs-keyword>const</span> Discord = <span class=hljs-built_in>require</span>(<span class=hljs-string>'discord.js'</span>);
<span class=hljs-keyword>const</span> bot = <span class=hljs-keyword>new</span> Discord.Client();
bot.commands = <span class=hljs-keyword>new</span> Discord.Collection();
<span class=hljs-keyword>const</span> botCommands = <span class=hljs-built_in>require</span>(<span class=hljs-string>'./commands'</span>);

<span class=hljs-built_in>Object</span>.keys(botCommands).map(<span class=hljs-function><span class=hljs-params>key</span> =></span> {
  bot.commands.set(botCommands[key].name, botCommands[key]);
});

<span class=hljs-keyword>const</span> TOKEN = process.env.TOKEN;

bot.login(TOKEN);

bot.on(<span class=hljs-string>'ready'</span>, <span class=hljs-function>() =></span> {
  <span class=hljs-built_in>console</span>.info(<span class=hljs-string>`Logged in as <span class=hljs-subst>${bot.user.tag}</span>!`</span>);
});

bot.on(<span class=hljs-string>'message'</span>, <span class=hljs-function><span class=hljs-params>msg</span> =></span> {
  <span class=hljs-keyword>const</span> args = msg.content.split(<span class=hljs-regexp>/ +/</span>);
  <span class=hljs-keyword>const</span> command = args.shift().toLowerCase();
  <span class=hljs-built_in>console</span>.info(<span class=hljs-string>`Called command: <span class=hljs-subst>${command}</span>`</span>);

  <span class=hljs-keyword>if</span> (!bot.commands.has(command)) <span class=hljs-keyword>return</span>;

  <span class=hljs-keyword>try</span> {
    bot.commands.get(command).execute(msg, args);
  } <span class=hljs-keyword>catch</span> (error) {
    <span class=hljs-built_in>console</span>.error(error);
    msg.reply(<span class=hljs-string>'there was an error trying to execute that command!'</span>);
  }
});</code></pre></div> <p>This code uses the <code>discord.js</code> plugin to create a Discord client, then logs in using the token. It then creates a collection and populates it with commands from the <code>/commands</code> folder (which doesn't exist yet but we are getting there). Once the bot is ready it will log a message saying it is logged in. The below code is where the message handling happens:</p> <div id=codeSnippet> <pre class=language-javascriptreact><code>bot.on(<span class=hljs-string>'message'</span>, <span class=hljs-function><span class=hljs-params>msg</span> =></span> {
  <span class=hljs-keyword>const</span> args = msg.content.split(<span class=hljs-regexp>/ +/</span>);
  <span class=hljs-keyword>const</span> command = args.shift().toLowerCase();
  <span class=hljs-built_in>console</span>.info(<span class=hljs-string>`Called command: <span class=hljs-subst>${command}</span>`</span>);

  <span class=hljs-keyword>if</span> (!bot.commands.has(command)) <span class=hljs-keyword>return</span>;

  <span class=hljs-keyword>try</span> {
    bot.commands.get(command).execute(msg, args);
  } <span class=hljs-keyword>catch</span> (error) {
    <span class=hljs-built_in>console</span>.error(error);
    msg.reply(<span class=hljs-string>'there was an error trying to execute that command!'</span>);
  }
});</code></pre></div> <p>It checks every message and separates by space into individual words, it then checks the first word to see if it is a command. If not it just does nothing. If so it tries to execute the command, and logs any errors.</p> <p>Now we should add the commands to make it actually do stuff. Create a folder called commands, and inside create <code>index.js</code> and <code>promote.js</code>. <code>promote.js</code> is my command so that can be whatever you want. Inside <code>promote.js</code> put the following code:</p> <div id=codeSnippet> <pre class=language-javascriptreact><code><span class=hljs-built_in>module</span>.exports = {
    <span class=hljs-attr>name</span>: <span class=hljs-string>'promote'</span>,
    <span class=hljs-attr>description</span>: <span class=hljs-string>'Promote Joshs Blog!'</span>,
    execute(msg, args) {
      <span class=hljs-keyword>const</span> embed = {
        <span class=hljs-string>"title"</span>: <span class=hljs-string>"Joshs Blog"</span>,
        <span class=hljs-string>"description"</span>: <span class=hljs-string>"My personal blog about Software Development, Sports, Music, and any more of my hobbies!"</span>,
        <span class=hljs-string>"url"</span>: <span class=hljs-string>"https://joshglasson.com"</span>,
        <span class=hljs-string>"color"</span>: <span class=hljs-built_in>Math</span>.floor(<span class=hljs-built_in>Math</span>.random()*<span class=hljs-number>16777215</span>),
        <span class=hljs-string>"timestamp"</span>: <span class=hljs-built_in>Date</span>.now()
      };
      msg.channel.send(<span class=hljs-string>"Check out my blog here: "</span>, { embed });
    },
};</code></pre></div> <p>Again I have used the <a href=https://leovoel.github.io/embed-visualizer/ target=_blank>embed visualiser</a> here to get the embed code:</p> <div id=imageDiv> <figure> <img alt="JS Code to Embed a Link" src=https://joshlearningtocode.files.wordpress.com/2020/09/discord-bot-js-embed.png> <figcaption>JavaScript Code to Embed a Link</figcaption> </figure> </div> <p>I have once again changed the colour and timestamp to be dynamic.</p> <p>Finally in <code>commands/index.js</code> we need to add the below:</p> <div id=codeSnippet> <pre class=language-javascriptreact><code><span class=hljs-built_in>module</span>.exports = {
    <span class=hljs-attr>Promote</span>: <span class=hljs-built_in>require</span>(<span class=hljs-string>'./promote'</span>),
};</code></pre></div> <p>We import any commands into this file, then import this file into the main <code>index.js</code>. This keeps it neater, as otherwise we would need to import each individual command into the main <code>index.js</code> file. We can now run the bot with <code>node index.js</code>.</p> <p>Here is the working JS bot:</p> <div id=imageDiv> <figure> <img alt="JS Bot Working in Discord" src=https://joshlearningtocode.files.wordpress.com/2020/09/discord-bot-js-message.png> <figcaption>JS Bot Working in Discord</figcaption> </figure> </div> <p>As you can see it works pretty much the same way. However the key difference is it doesn't take a prefix, which may lead to confusion as it could trigger when it shouldn't. I updated my code to ensure it only picks up words with the <code>?</code> prefix as it does in the Ruby version. The below is what I added to the <code>on message</code> function in the main <code>index.js</code>, before the check for the command existing:</p> <div id=codeSnippet> <pre class=language-javascriptreact><code><span class=hljs-keyword>if</span> (command.slice(<span class=hljs-number>0</span>,<span class=hljs-number>1</span>) != <span class=hljs-string>'?'</span>) {
  <span class=hljs-keyword>return</span>;
} <span class=hljs-keyword>else</span> {
  command = command.slice(<span class=hljs-number>1</span>)
}</code></pre></div> <p>Here it is in action</p> <div id=imageDiv> <figure> <img alt="JS Bot" src=https://joshlearningtocode.files.wordpress.com/2020/09/discord-bot-js-messages-with-prefix.gif> </figure> </div> <p>Now everything was working I added more info to my embed:</p> <div id=imageDiv> <figure> <img alt="JS Embed with Logo" src=https://joshlearningtocode.files.wordpress.com/2020/09/discord-bot-js-embed-with-images.png> <figcaption>JS Embed with Logo</figcaption> </figure> </div> <br> <p>You can find the <a href=https://github.com/JoshGlasson/Discord-Bot target=_blank>code on my GitHub</a></p> <p>And that is it for now. I find little things like this very interesting, I may revisit this and add more to it in the future, so look out for a part 2 one day!</p> <br> <h1><em><strong>UPDATE: Thu Sep 03 2020</strong></em></h1> <h2><em><strong>Adding Python</strong></em></h2> <br> <h1 id=python>Python</h1> <h2 id=register-the-bot>Register the Bot</h2> <p>Again we need to have a bot setup and an auth token ready to use. Follow the setup process in the Ruby guide for this if you haven't done it already, and then follow the guide in the JavaScript section to add it to your server.</p> <h2 id=project-setup-2>Project Setup</h2> <p>Despite having PyCharm installed, I decided to stick with VSCode for the Python code. It actually works pretty well, well enough for the simple project I am going to be doing anyway! If you too want to use VSCode, I would follow <a href=https://code.visualstudio.com/docs/python/python-tutorial target=_blank>this guide</a> to get it setup for Python.</p> <p>Now the IDE is setup we can start on the project. I was following <a href=https://www.devdungeon.com/content/make-discord-bot-python target=_blank>this guide</a> to start with, but ran into all sorts of problems with python, so will try to explain exactly what I did.</p> <p>Firstly we need the <code>discord.py</code> library. There are some issues with this library working on the newest version of python, so use the below commands to get it working:</p> <div id=codeSnippet> <pre class=language-javascriptreact><code>python3 -m pip install -U <span class=hljs-string>"https://github.com/Rapptz/discord.py/archive/async.zip#egg=discord.py[voice]"</span>
python3 -m pip install --upgrade aiohttp
python3 -m pip install --upgrade websockets</code></pre></div> <p>I am not sure the second and third commands are necessary, but it worked for me! Now we can get started, so in your project folder, create a file called <code>bot.py</code> and add the following code:</p> <div id=codeSnippet> <pre class=language-javascriptreact><code><span class=hljs-keyword>import</span> discord

TOKEN = <span class=hljs-string>'PUT YOUR TOKEN HERE'</span>

client = discord.Client()

<span class=hljs-meta>@client.event</span>
<span class=hljs-keyword>async</span> <span class=hljs-function><span class=hljs-keyword>def</span> <span class=hljs-title>on_message</span>(<span class=hljs-params>message</span>):</span>
    <span class=hljs-comment># we do not want the bot to reply to itself</span>
    <span class=hljs-keyword>if</span> message.author == client.user:
        <span class=hljs-keyword>return</span>

    <span class=hljs-keyword>if</span> message.content.startswith(<span class=hljs-string>'!hello'</span>):
        msg = <span class=hljs-string>'Hello {0.author.mention}'</span>.format(message)
        <span class=hljs-keyword>await</span> client.send_message(message.channel, msg)

<span class=hljs-meta>@client.event</span>
<span class=hljs-keyword>async</span> <span class=hljs-function><span class=hljs-keyword>def</span> <span class=hljs-title>on_ready</span>():</span>
    print(<span class=hljs-string>'Logged in as'</span>)
    print(client.user.name)
    print(client.user.id)
    print(<span class=hljs-string>'------'</span>)

client.run(TOKEN)</code></pre></div> <p>After adding your token, try to run this python file in the terminal using <code>python3 /path/to/file/bot.py</code> (or the play button in the top right in VSCode).</p> <p>At this point you may run into an SSLError, something like this will be in the stack trace.</p> <div id=codeSnippet> <pre class=language-javascriptreact><code>Cannot connect to host discordapp.com:443 ssl:True 
[SSLCertVerificationError: (1, <span class=hljs-string>'[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:1056)'</span>)]</code></pre></div> <p>If this does happen to you, navigate to your root directory, then go to <code>Applications/Python 3.7</code> and run the <code>Install Certificates.command</code> file. Now if you re-run the python script, it should work!</p> <p>You should be able to see your bot in your channel, and sending <code>!hello</code> should prompt it to reply and tag you in the response.</p> <div id=imageDiv> <figure> <img alt="Python Bot Hello" src=https://joshlearningtocode.files.wordpress.com/2020/09/discord-bot-py-hello.png> <figcaption>Python Bot Hello</figcaption> </figure> </div> <p>The bot is up and running now, so we can make some more tweaks. Instead of hardcoding my token into the <code>bot.py</code> file, I want to use <code>dotenv</code> as I have for my JavaScript bot. I installed the plugin with <code>python3 -m pip install python-dotenv</code>, and created a <code>.env</code> file with my token inside, in a key value pair format. For example <code>TOKEN="My token"</code>.</p> <p>To get this into my <code>bot.py</code> file, I had to add a few things at the top:</p> <div id=codeSnippet> <pre class=language-javascriptreact><code><span class=hljs-keyword>import</span> discord
<span class=hljs-keyword>from</span> dotenv <span class=hljs-keyword>import</span> load_dotenv
<span class=hljs-keyword>import</span> os

load_dotenv()
TOKEN = os.environ.get(<span class=hljs-string>'TOKEN'</span>)</code></pre></div> <p>Next I wanted to update my code to look for the <code>?</code> prefix, as it has in the other two projects. To do this I added another <code>if</code> block after the check that the bot is not replying to itself:</p> <div id=codeSnippet> <pre class=language-javascriptreact><code><span class=hljs-keyword>if</span> message.content.startswith(<span class=hljs-string>'?'</span>):
    command = message.content[<span class=hljs-number>1</span>:]
    print(<span class=hljs-string>"Command received: "</span> + command)
<span class=hljs-keyword>else</span>:
    print(<span class=hljs-string>"Commands should start with ?"</span>)
    <span class=hljs-keyword>return</span></code></pre></div> <p>If a message starts with <code>?</code>, then I trim the message to not include the <code>?</code> and save that into my <code>command</code> variable. If it does not start with <code>?</code> I print a log then <code>return</code>, so none of the rest of the code after this point is executed.</p> <p>Now I could add the <code>promote</code> command I have been working with on the other projects.</p> <div id=codeSnippet> <pre class=language-javascriptreact><code><span class=hljs-keyword>if</span> command.startswith(<span class=hljs-string>'promote'</span>):
  colour=random.randint(<span class=hljs-number>0</span>, <span class=hljs-number>0xFFFFFF</span>)
  embed = discord.Embed(title=<span class=hljs-string>"Joshs Blog"</span>, colour=discord.Colour(colour), url=<span class=hljs-string>"https://joshglasson.com"</span>, description=<span class=hljs-string>"My personal blog about Software Development, Sports, Music, and any more of my hobbies!"</span>, timestamp=datetime.utcnow())
  embed.set_image(url=<span class=hljs-string>"https://joshglasson.com/logo.png"</span>)
  embed.set_thumbnail(url=<span class=hljs-string>"https://joshglasson.com/logo.png"</span>)
  embed.set_author(name=<span class=hljs-string>"Josh Glasson"</span>, url=<span class=hljs-string>"https://joshglasson.com"</span>, icon_url=<span class=hljs-string>"https://joshglasson.com/logo.png"</span>)
  <span class=hljs-keyword>await</span> client.send_message(message.channel, embed=embed)
  print(<span class=hljs-string>"Command executed: "</span> + command)</code></pre></div> <p>Once again I am picking a random colour and setting the time to now. To do this I used <code>random</code> and <code>datetime</code>, both of which have to be imported. I used the embed visualiser to get the right code for embedding, although had to tweek some bits to make it work with my bot.</p> <div id=imageDiv> <figure> <img alt="Python Embed Visualiser" src=https://joshlearningtocode.files.wordpress.com/2020/09/discord-bot-python-visualizer.png> <figcaption>Python Embed Visualiser</figcaption> </figure> </div> <p>Here is the full <code>bot.py</code> code:</p> <div id=codeSnippet> <pre class=language-javascriptreact><code><span class=hljs-keyword>import</span> discord
<span class=hljs-keyword>from</span> datetime <span class=hljs-keyword>import</span> datetime
<span class=hljs-keyword>import</span> random
<span class=hljs-keyword>from</span> dotenv <span class=hljs-keyword>import</span> load_dotenv
<span class=hljs-keyword>import</span> os

load_dotenv()
TOKEN = os.environ.get(<span class=hljs-string>'TOKEN'</span>)

client = discord.Client()

<span class=hljs-meta>@client.event</span>
<span class=hljs-keyword>async</span> <span class=hljs-function><span class=hljs-keyword>def</span> <span class=hljs-title>on_message</span>(<span class=hljs-params>message</span>):</span>
    <span class=hljs-comment># we do not want the bot to reply to itself</span>
    <span class=hljs-keyword>if</span> message.author == client.user:
        <span class=hljs-keyword>return</span>

    <span class=hljs-keyword>if</span> message.content.startswith(<span class=hljs-string>'?'</span>):
        command = message.content[<span class=hljs-number>1</span>:]
        print(<span class=hljs-string>"Command received: "</span> + command)
    <span class=hljs-keyword>else</span>:
        print(<span class=hljs-string>"Commands should start with ?"</span>)
        <span class=hljs-keyword>return</span>

    <span class=hljs-keyword>if</span> command.startswith(<span class=hljs-string>'hello'</span>):
        msg = <span class=hljs-string>'Hello {0.author.mention}'</span>.format(message)
        <span class=hljs-keyword>await</span> client.send_message(message.channel, msg)
        print(<span class=hljs-string>"Command executed: "</span> + command)
        <span class=hljs-keyword>return</span>

    <span class=hljs-keyword>if</span> command.startswith(<span class=hljs-string>'promote'</span>):
        colour=random.randint(<span class=hljs-number>0</span>, <span class=hljs-number>0xFFFFFF</span>)
        embed = discord.Embed(title=<span class=hljs-string>"Joshs Blog"</span>, colour=discord.Colour(colour), url=<span class=hljs-string>"https://joshglasson.com"</span>, description=<span class=hljs-string>"My personal blog about Software Development, Sports, Music, and any more of my hobbies!"</span>, timestamp=datetime.utcnow())
        embed.set_image(url=<span class=hljs-string>"https://joshglasson.com/logo.png"</span>)
        embed.set_thumbnail(url=<span class=hljs-string>"https://joshglasson.com/logo.png"</span>)
        embed.set_author(name=<span class=hljs-string>"Josh Glasson"</span>, url=<span class=hljs-string>"https://joshglasson.com"</span>, icon_url=<span class=hljs-string>"https://joshglasson.com/logo.png"</span>)
        <span class=hljs-keyword>await</span> client.send_message(message.channel, embed=embed)
        print(<span class=hljs-string>"Command executed: "</span> + command)
        <span class=hljs-keyword>return</span>

    print(<span class=hljs-string>"Command "</span> + command + <span class=hljs-string>" does not match any known commands"</span>)

<span class=hljs-meta>@client.event</span>
<span class=hljs-keyword>async</span> <span class=hljs-function><span class=hljs-keyword>def</span> <span class=hljs-title>on_ready</span>():</span>
    print(<span class=hljs-string>'Logged in as'</span>)
    print(client.user.name)
    print(client.user.id)
    print(<span class=hljs-string>'------'</span>)

client.run(TOKEN)</code></pre></div> <p>And here it is in action:</p> <div id=imageDiv> <figure> <img alt="Python Bot" src=https://joshlearningtocode.files.wordpress.com/2020/09/discord-bot-python.png> <figcaption>Python Bot</figcaption> </figure> </div> <p>You may have spotted the timestamp on the embed and the actual time are an hour apart. That is because I was using <code>datetime.now()</code> which was returning the time in BST, however Discord was expecting UTC and tried to convert it to BST again for me, hence it becomes an hour ahead of what it should be. I have updated the code above to use <code>datetime.utcnow()</code> which fixes this problem!</p> <p>As with before the <a href=https://github.com/JoshGlasson/Discord-Bot target=_blank>code is on my GitHub</a> if you want to check it out.</p> </div> <br> <div class=svelte-b7hd5f><a href=about><img alt=Me src="./images/about/Small Profile Pic.jpg" class="svelte-b7hd5f signature-image"></a> <h3 class=svelte-b7hd5f>Post by</h3> <a href=about><h1 class=svelte-b7hd5f>Josh Glasson</h1></a> <h3 class=svelte-b7hd5f>Software Developer. Creator and owner of this blog.</h3></div> <div id=recentPosts></div> <div id=relatedPosts></div> <div class=pswp aria-hidden=true role=dialog tabindex=-1> <div class=pswp__bg></div> <div class=pswp__scroll-wrap> <div class=pswp__container><div class=pswp__item></div> <div class=pswp__item></div> <div class=pswp__item></div></div> <div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar> <div class=pswp__counter></div> <button class="pswp__button pswp__button--close" title="Close (Esc)"></button> <button class="pswp__button pswp__button--share" title=Share></button> <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button> <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button> <div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div> <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div> <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button> <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button> <div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div></main></div> <script>__SAPPER__={baseUrl:"",preloaded:[void 0,null,(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){return {post:{html:"\u003Cp\u003EI was sitting at home yesterday thinking it would be good to work on something small just for some practice. I stumbled upon a \u003Ca href=\"https:\u002F\u002Fwww.maxbits.net\u002Fblog\u002Fpost\u002FWriting-a-Discord-Bot-in-Ruby-using-DiscordRB\u002F\" target=\"_blank\"\u003Eblog post\u003C\u002Fa\u003E regarding making a discord bot, and decided it would be cool to give it a go.\u003C\u002Fp\u003E\n\u003Cp\u003EThe blog shows the process using Ruby. I hadn&#39;t used Ruby for a while so it wasn&#39;t easy for me to pick it up and remember the syntax. For that reason I decided I would also do it in JavaScript as I know more about it. I found a guide \u003Ca href=\"https:\u002F\u002Fwww.sitepoint.com\u002Fdiscord-bot-node-js\u002F\" target=\"_blank\"\u003Ehere\u003C\u002Fa\u003E which was really helpful.\u003C\u002Fp\u003E\n\u003Cbr\u003E\n\n\u003Ch1 id=\"ruby\"\u003ERuby\u003C\u002Fh1\u003E\n\u003Cp\u003ESo as I mentioned above, I pretty much followed the blog I linked, with only a few minor changes to get things working, and instead of just sending a test message I wanted to send a link to my blog. I will go through the steps from the start, but credit to the above blog for most of the work!\u003C\u002Fp\u003E\n\u003Ch2 id=\"register-your-bot\"\u003ERegister Your Bot\u003C\u002Fh2\u003E\n\u003Cp\u003ETo start with, you need to create a new Application in the \u003Ca href=\"https:\u002F\u002Fdiscord.com\u002Fdevelopers\u002Fapplications\" target=\"_blank\"\u003EDiscord Develper Portal\u003C\u002Fa\u003E, which you can call whatever you want. I gave it the same name I wanted to give my bot, just to make life easier! Once you have a new application, go to the Bot tab, and press Add Bot. We will need its token and client id soon.\u003C\u002Fp\u003E\n\u003Cdiv id=\"imageDiv\"\u003E\n  \u003Cfigure\u003E\n    \u003Cimg src=\"https:\u002F\u002Fjoshlearningtocode.files.wordpress.com\u002F2020\u002F09\u002Fdiscord-bot-new-application.png\" alt=\"Creating a New Application\"\u002F\u003E\n    \u003Cfigcaption\u003ECreating a New Application\u003C\u002Ffigcaption\u003E\n  \u003C\u002Ffigure\u003E\n\u003C\u002Fdiv\u003E\n\n\u003Ch2 id=\"project-setup\"\u003EProject Setup\u003C\u002Fh2\u003E\n\u003Cp\u003EIn your IDE of choice, create a project with the following structure.\u003C\u002Fp\u003E\n\u003Cdiv id=\"imageDiv\"\u003E\n  \u003Cfigure\u003E\n    \u003Cimg src=\"https:\u002F\u002Fjoshlearningtocode.files.wordpress.com\u002F2020\u002F09\u002Fdiscord-bot-project-structure.png\" alt=\"Project Structure\"\u002F\u003E\n    \u003Cfigcaption\u003EProject Structure\u003C\u002Ffigcaption\u003E\n  \u003C\u002Ffigure\u003E\n\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EIf you haven&#39;t used Ruby before, the \u003Ccode\u003EGemfile\u003C\u002Fcode\u003E is used to define dependencies. So starting with the \u003Ccode\u003EGemfile\u003C\u002Fcode\u003E, the first thing we need to do is get the \u003Ccode\u003Ediscordrb\u003C\u002Fcode\u003E gem, so add the below to your \u003Ccode\u003EGemfile\u003C\u002Fcode\u003E:\u003C\u002Fp\u003E\n\u003Cdiv id=\"codeSnippet\"\u003E\n\n\u003Cpre class='language-javascriptreact'\u003E\u003Ccode\u003Esource \u003Cspan class=\"hljs-string\"\u003E&#x27;https:\u002F\u002Frubygems.org&#x27;\u003C\u002Fspan\u003E\ngem \u003Cspan class=\"hljs-string\"\u003E&#x27;discordrb&#x27;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EIn the post I followed they did not define a \u003Ccode\u003Esource\u003C\u002Fcode\u003E, however I needed it to make this work. To install the dependency, run \u003Ccode\u003Ebundle install\u003C\u002Fcode\u003E. You should have \u003Ccode\u003EBundler\u003C\u002Fcode\u003E installed already if you have Ruby. If not, now would be a good time to install Ruby!\u003C\u002Fp\u003E\n\u003Cp\u003ENext, we can put the below into \u003Ccode\u003Erun.rb\u003C\u002Fcode\u003E:\u003C\u002Fp\u003E\n\u003Cdiv id=\"codeSnippet\"\u003E\n\n\u003Cpre class='language-javascriptreact'\u003E\u003Ccode\u003Erequire_relative \u003Cspan class=\"hljs-string\"\u003E&#x27;src\u002Fbot&#x27;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\n\u003Cp\u003E\u003Ccode\u003Erun.rb\u003C\u002Fcode\u003E is acting a shortcut to the \u003Ccode\u003Ebot.rb\u003C\u002Fcode\u003E file where we are actually going to run our code. So lets give it some code to run, in \u003Ccode\u003Esrc\u002Fbot.rb\u003C\u002Fcode\u003E add:\u003C\u002Fp\u003E\n\u003Cdiv id=\"codeSnippet\"\u003E\n\n\u003Cpre class='language-javascriptreact'\u003E\u003Ccode\u003E\u003Cspan class=\"hljs-keyword\"\u003Erequire\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-string\"\u003E&#x27;discordrb&#x27;\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-keyword\"\u003Erequire\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-string\"\u003E&#x27;ostruct&#x27;\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-keyword\"\u003Erequire\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-string\"\u003E&#x27;yaml&#x27;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"hljs-class\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Emodule\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003EBot\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E File.file? \u003Cspan class=\"hljs-string\"\u003E&#x27;data\u002Fconfig.yaml&#x27;\u003C\u002Fspan\u003E\n        CONFIG = OpenStruct.new YAML.load_file \u003Cspan class=\"hljs-string\"\u003E&#x27;data\u002Fconfig.yaml&#x27;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Eelse\u003C\u002Fspan\u003E\n        puts \u003Cspan class=\"hljs-string\"\u003E&#x27;Can\\&#x27;t load config file!&#x27;\u003C\u002Fspan\u003E\n        exit!\n    \u003Cspan class=\"hljs-keyword\"\u003Eend\u003C\u002Fspan\u003E\n\n    BOT = Discordrb::Commands::CommandBot.new(\u003Cspan class=\"hljs-symbol\"\u003Eclient_id:\u003C\u002Fspan\u003E CONFIG.client_id, \u003Cspan class=\"hljs-symbol\"\u003Etoken:\u003C\u002Fspan\u003E CONFIG.token, \u003Cspan class=\"hljs-symbol\"\u003Eprefix:\u003C\u002Fspan\u003E CONFIG.prefix)\n\n    \u003Cspan class=\"hljs-comment\"\u003E# Discord Commands\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-class\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Emodule\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003EDiscordCommands\u003C\u002Fspan\u003E;\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-keyword\"\u003Eend\u003C\u002Fspan\u003E\n    Dir[\u003Cspan class=\"hljs-string\"\u003E&#x27;src\u002Fmodules\u002Fcommands\u002F*.rb&#x27;\u003C\u002Fspan\u003E].each { \u003Cspan class=\"hljs-params\"\u003E|mod|\u003C\u002Fspan\u003E load mod }\n    DiscordCommands.constants.each \u003Cspan class=\"hljs-keyword\"\u003Edo\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-params\"\u003E|mod|\u003C\u002Fspan\u003E\n        BOT.\u003Cspan class=\"hljs-keyword\"\u003Einclude\u003C\u002Fspan\u003E! DiscordCommands.const_get mod\n    \u003Cspan class=\"hljs-keyword\"\u003Eend\u003C\u002Fspan\u003E\n\n    \u003Cspan class=\"hljs-comment\"\u003E# Discord Events\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-class\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Emodule\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003EDiscordEvents\u003C\u002Fspan\u003E;\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-keyword\"\u003Eend\u003C\u002Fspan\u003E\n    Dir[\u003Cspan class=\"hljs-string\"\u003E&#x27;src\u002Fmodules\u002Fevents\u002F*.rb&#x27;\u003C\u002Fspan\u003E].each { \u003Cspan class=\"hljs-params\"\u003E|mod|\u003C\u002Fspan\u003E load mod }\n    DiscordEvents.constants.each \u003Cspan class=\"hljs-keyword\"\u003Edo\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-params\"\u003E|mod|\u003C\u002Fspan\u003E\n        BOT.\u003Cspan class=\"hljs-keyword\"\u003Einclude\u003C\u002Fspan\u003E! DiscordEvents.const_get mod\n    \u003Cspan class=\"hljs-keyword\"\u003Eend\u003C\u002Fspan\u003E\n\n    BOT.run\n\u003Cspan class=\"hljs-keyword\"\u003Eend\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EThe blog post I followed gives some good descriptions of what each part of this code is doing, so probably worth checking that out.\u003C\u002Fp\u003E\n\u003Cp\u003EYou can see in the code above, we are getting some information from \u003Ccode\u003ECONFIG\u003C\u002Fcode\u003E. This is coming from the \u003Ccode\u003Edata\u002Fconfig.yaml\u003C\u002Fcode\u003E file, which has three properties in it:\u003C\u002Fp\u003E\n\u003Cdiv id=\"codeSnippet\"\u003E\n\n\u003Cpre class='language-javascriptreact'\u003E\u003Ccode\u003E\u003Cspan class=\"hljs-symbol\"\u003Eclient_id:\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-string\"\u003E&#x27;Client Id (From the Dev Portal)&#x27;\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-symbol\"\u003Etoken:\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-string\"\u003E&#x27;Your Token (From the Dev Portal)&#x27;\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-symbol\"\u003Eprefix:\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-string\"\u003E&#x27;?&#x27;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EThe client id and token both come from the Bot tab in the Discord Dev Portal. The prefix can be whatever you want, and will be used to call your bot with commands.\u003C\u002Fp\u003E\n\u003Cp\u003ENow that&#39;s all set up we can actually give it a command to work with. The post I followed gave a simple example of sending \u003Ccode\u003E?ping\u003C\u002Fcode\u003E and the bot responding with \u003Cem\u003Epong\u003C\u002Fem\u003E. However that isn&#39;t very interesting, so I am branching off here for a moment! I wanted my bot to promote my blog, by sending a link to it in the chat. So in \u003Ccode\u003Esrc\u002Fmodules\u002Fcommands\u002F\u003C\u002Fcode\u003E I added a file called \u003Ccode\u003Epromote.rb\u003C\u002Fcode\u003E, in which I added the following code:\u003C\u002Fp\u003E\n\u003Cdiv id=\"codeSnippet\"\u003E\n\n\u003Cpre class='language-javascriptreact'\u003E\u003Ccode\u003E\u003Cspan class=\"hljs-keyword\"\u003Erequire\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-string\"\u003E&#x27;discordrb\u002Fwebhooks&#x27;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"hljs-class\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Emodule\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003EBot\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-class\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Emodule\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003EDiscordCommands\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n        \u003Cspan class=\"hljs-class\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Emodule\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003EPromote\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003Eextend\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003EDiscordrb::Commands::CommandContainer\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n            command \u003Cspan class=\"hljs-symbol\"\u003E:promote\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-keyword\"\u003Edo\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-params\"\u003E|event|\u003C\u002Fspan\u003E\n                event.channel.send_embed(\u003Cspan class=\"hljs-string\"\u003E&quot;Check out my blog here: &quot;\u003C\u002Fspan\u003E) \u003Cspan class=\"hljs-keyword\"\u003Edo\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-params\"\u003E|embed|\u003C\u002Fspan\u003E\n                    embed.title = \u003Cspan class=\"hljs-string\"\u003E&quot;Joshs Blog&quot;\u003C\u002Fspan\u003E\n                    embed.colour = Random.bytes(\u003Cspan class=\"hljs-number\"\u003E3\u003C\u002Fspan\u003E).unpack1(\u003Cspan class=\"hljs-string\"\u003E&#x27;H*&#x27;\u003C\u002Fspan\u003E)\n                    embed.url = \u003Cspan class=\"hljs-string\"\u003E&quot;https:\u002F\u002Fjoshglasson.com&quot;\u003C\u002Fspan\u003E\n                    embed.description = \u003Cspan class=\"hljs-string\"\u003E&quot;My personal blog about Software Development, Sports, Music, and any more of my hobbies!&quot;\u003C\u002Fspan\u003E\n                    embed.timestamp = Time.at(Time.now())\n                \u003Cspan class=\"hljs-keyword\"\u003Eend\u003C\u002Fspan\u003E\n            \u003Cspan class=\"hljs-keyword\"\u003Eend\u003C\u002Fspan\u003E\n        \u003Cspan class=\"hljs-keyword\"\u003Eend\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Eend\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-keyword\"\u003Eend\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\n\u003Cp\u003ETheres two parts to this to explain really. Firstly:\u003C\u002Fp\u003E\n\u003Cdiv id=\"codeSnippet\"\u003E\n\n\u003Cpre class='language-javascriptreact'\u003E\u003Ccode\u003E\u003Cspan class=\"hljs-class\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Emodule\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003EBot\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-class\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Emodule\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003EDiscordCommands\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n        \u003Cspan class=\"hljs-class\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Emodule\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003EPromote\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003Eextend\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003EDiscordrb::Commands::CommandContainer\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n            command \u003Cspan class=\"hljs-symbol\"\u003E:promote\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-keyword\"\u003Edo\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-params\"\u003E|event|\u003C\u002Fspan\u003E\n              \u003Cspan class=\"hljs-comment\"\u003E# not important right now\u003C\u002Fspan\u003E\n            \u003Cspan class=\"hljs-keyword\"\u003Eend\u003C\u002Fspan\u003E\n        \u003Cspan class=\"hljs-keyword\"\u003Eend\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Eend\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-keyword\"\u003Eend\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EThis is the code to handle commands. We have extended \u003Ccode\u003EDiscordrb::Commands::CommandContainer\u003C\u002Fcode\u003E which comes from the \u003Ccode\u003Ediscordrb\u003C\u002Fcode\u003E plugin, and added code in to handle commands. In this case, \u003Ccode\u003Ecommand :promote do |event|\u003C\u002Fcode\u003E will listen for a \u003Ccode\u003Epromote\u003C\u002Fcode\u003E command, and do something if it receives it.\u003C\u002Fp\u003E\n\u003Cdiv id=\"codeSnippet\"\u003E\n\n\u003Cpre class='language-javascriptreact'\u003E\u003Ccode\u003E\u003Cspan class=\"hljs-keyword\"\u003Erequire\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-string\"\u003E&#x27;discordrb\u002Fwebhooks&#x27;\u003C\u002Fspan\u003E\n\ncommand \u003Cspan class=\"hljs-symbol\"\u003E:promote\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-keyword\"\u003Edo\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-params\"\u003E|event|\u003C\u002Fspan\u003E\n    event.channel.send_embed(\u003Cspan class=\"hljs-string\"\u003E&quot;Check out my blog here: &quot;\u003C\u002Fspan\u003E) \u003Cspan class=\"hljs-keyword\"\u003Edo\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-params\"\u003E|embed|\u003C\u002Fspan\u003E\n        embed.title = \u003Cspan class=\"hljs-string\"\u003E&quot;Joshs Blog&quot;\u003C\u002Fspan\u003E\n        embed.colour = Random.bytes(\u003Cspan class=\"hljs-number\"\u003E3\u003C\u002Fspan\u003E).unpack1(\u003Cspan class=\"hljs-string\"\u003E&#x27;H*&#x27;\u003C\u002Fspan\u003E)\n        embed.url = \u003Cspan class=\"hljs-string\"\u003E&quot;https:\u002F\u002Fjoshglasson.com&quot;\u003C\u002Fspan\u003E\n        embed.description = \u003Cspan class=\"hljs-string\"\u003E&quot;My personal blog about Software Development, Sports, Music, and any more of my hobbies!&quot;\u003C\u002Fspan\u003E\n        embed.timestamp = Time.at(Time.now())\n    \u003Cspan class=\"hljs-keyword\"\u003Eend\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-keyword\"\u003Eend\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EInside the command block is some code to embed a link. To use this we have to import \u003Ccode\u003Ediscordrb\u002Fwebhooks\u003C\u002Fcode\u003E. Then we can use that to send an embedded link to the channel. I used the \u003Ca href=\"https:\u002F\u002Fleovoel.github.io\u002Fembed-visualizer\u002F\" target=\"_blank\"\u003EDiscord Embed Visualiser\u003C\u002Fa\u003E to help me build the code.\u003C\u002Fp\u003E\n\u003Cdiv id=\"imageDiv\"\u003E\n  \u003Cfigure\u003E\n    \u003Cimg src=\"https:\u002F\u002Fjoshlearningtocode.files.wordpress.com\u002F2020\u002F09\u002Fdiscord-bot-ruby-embed.png\" alt=\"Ruby Code to Embed a Link\"\u002F\u003E\n    \u003Cfigcaption\u003ERuby Code to Embed a Link\u003C\u002Ffigcaption\u003E\n  \u003C\u002Ffigure\u003E\n\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EI replaced the colour with some code that randomly generates a hex code instead, and the hardcoded timestamp with a dynamic time instead.\u003C\u002Fp\u003E\n\u003Cp\u003EThe last part is the same as the original post. In \u003Ccode\u003Eevents\u002Fonline.rb\u003C\u002Fcode\u003E we add the following code:\u003C\u002Fp\u003E\n\u003Cdiv id=\"codeSnippet\"\u003E\n\n\u003Cpre class='language-javascriptreact'\u003E\u003Ccode\u003E\u003Cspan class=\"hljs-class\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Emodule\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003EBot\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-class\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Emodule\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003EDiscordEvents\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n        \u003Cspan class=\"hljs-class\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Emodule\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003EOnline\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003Eextend\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003EDiscordrb::EventContainer\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n            ready \u003Cspan class=\"hljs-keyword\"\u003Edo\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-params\"\u003E|event|\u003C\u002Fspan\u003E\n                puts \u003Cspan class=\"hljs-string\"\u003E&quot;Logged in as \u003Cspan class=\"hljs-subst\"\u003E#{event.bot.profile.distinct}\u003C\u002Fspan\u003E&quot;\u003C\u002Fspan\u003E\n                puts \u003Cspan class=\"hljs-string\"\u003E&quot;Invite URL: \u003Cspan class=\"hljs-subst\"\u003E#{event.bot.invite_url}\u003C\u002Fspan\u003E&quot;\u003C\u002Fspan\u003E\n            \u003Cspan class=\"hljs-keyword\"\u003Eend\u003C\u002Fspan\u003E\n        \u003Cspan class=\"hljs-keyword\"\u003Eend\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Eend\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-keyword\"\u003Eend\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EUpon running \u003Ccode\u003Eruby run.rb\u003C\u002Fcode\u003E, you should see a message like this:\u003C\u002Fp\u003E\n\u003Cdiv id=\"codeSnippet\"\u003E\n\n\u003Cpre class='language-javascriptreact'\u003E\u003Ccode\u003E[INFO : websocket @ 2020-09-02 09:25:30.187] Discord using gateway protocol version: 6, requested: 6\nLogged \u003Cspan class=\"hljs-keyword\"\u003Ein\u003C\u002Fspan\u003E as JoshsBlogPromoter\u003Cspan class=\"hljs-comment\"\u003E#0931\u003C\u002Fspan\u003E\nInvite URL: https:\u002F\u002Fdiscordapp.com\u002Foauth2\u002Fauthorize?&amp;client_id=750398124148654120&amp;scope=bot\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EIf you follow the link, it should give you the option of adding the bot to one of your discord servers. Now you can test it by sending it a message, in this case \u003Ccode\u003E?promote\u003C\u002Fcode\u003E:\u003C\u002Fp\u003E\n\u003Cdiv id=\"imageDiv\"\u003E\n  \u003Cfigure\u003E\n    \u003Cimg src=\"https:\u002F\u002Fjoshlearningtocode.files.wordpress.com\u002F2020\u002F09\u002Fdiscord-bot-ruby-message.png\" alt=\"Ruby Bot Working in Discord\"\u002F\u003E\n    \u003Cfigcaption\u003ERuby Bot Working in Discord\u003C\u002Ffigcaption\u003E\n  \u003C\u002Ffigure\u003E\n\u003C\u002Fdiv\u003E\n\n\u003Cbr\u003E\n\n\u003Ch1 id=\"javascript\"\u003EJavaScript\u003C\u002Fh1\u003E\n\u003Cp\u003ESo now we have a Ruby Discord Bot working, lets make one in JavaScript.\u003C\u002Fp\u003E\n\u003Ch2 id=\"bot-setup\"\u003EBot Setup\u003C\u002Fh2\u003E\n\u003Cp\u003EFirstly if you did not create an Application and Bot in the Ruby guide, do so now. Once that is done, go to the \u003Cstrong\u003EOAuth2\u003C\u002Fstrong\u003E tab and setup the permissions you want your bot to have. In \u003Cstrong\u003E\u003Cem\u003EScopes\u003C\u002Fem\u003E\u003C\u002Fstrong\u003E tick \u003Cem\u003Ebot\u003C\u002Fem\u003E, and in \u003Cstrong\u003E\u003Cem\u003EBot Permissions\u003C\u002Fem\u003E\u003C\u002Fstrong\u003E I have ticked \u003Cem\u003ESend Messages\u003C\u002Fem\u003E and \u003Cem\u003ERead Message History\u003C\u002Fem\u003E. If you want it to do more, of course you can tick more options. Doing this should update the link in \u003Cstrong\u003E\u003Cem\u003EScopes\u003C\u002Fem\u003E\u003C\u002Fstrong\u003E, and once you are happy, copy this link into your browser. This should take you to a page to add your bot to your server.\u003C\u002Fp\u003E\n\u003Ch2 id=\"project-setup-1\"\u003EProject Setup\u003C\u002Fh2\u003E\n\u003Cp\u003ETo start with, create 2 files. Firstly create a \u003Ccode\u003Epackage.json\u003C\u002Fcode\u003E file with the below:\u003C\u002Fp\u003E\n\u003Cdiv id=\"codeSnippet\"\u003E\n\n\u003Cpre class='language-javascriptreact'\u003E\u003Ccode\u003E{\n  \u003Cspan class=\"hljs-attr\"\u003E&quot;name&quot;\u003C\u002Fspan\u003E: \u003Cspan class=\"hljs-string\"\u003E&quot;discord-bot&quot;\u003C\u002Fspan\u003E,\n  \u003Cspan class=\"hljs-attr\"\u003E&quot;version&quot;\u003C\u002Fspan\u003E: \u003Cspan class=\"hljs-string\"\u003E&quot;1.0.0&quot;\u003C\u002Fspan\u003E,\n  \u003Cspan class=\"hljs-attr\"\u003E&quot;description&quot;\u003C\u002Fspan\u003E: \u003Cspan class=\"hljs-string\"\u003E&quot;My Discord Bot&quot;\u003C\u002Fspan\u003E,\n  \u003Cspan class=\"hljs-attr\"\u003E&quot;main&quot;\u003C\u002Fspan\u003E: \u003Cspan class=\"hljs-string\"\u003E&quot;index.js&quot;\u003C\u002Fspan\u003E,\n  \u003Cspan class=\"hljs-attr\"\u003E&quot;scripts&quot;\u003C\u002Fspan\u003E: {\n    \u003Cspan class=\"hljs-attr\"\u003E&quot;test&quot;\u003C\u002Fspan\u003E: \u003Cspan class=\"hljs-string\"\u003E&quot;echo \\&quot;Error: no test specified\\&quot; &amp;&amp; exit 1&quot;\u003C\u002Fspan\u003E\n  },\n  \u003Cspan class=\"hljs-attr\"\u003E&quot;author&quot;\u003C\u002Fspan\u003E: \u003Cspan class=\"hljs-string\"\u003E&quot;Josh Glasson&quot;\u003C\u002Fspan\u003E,\n  \u003Cspan class=\"hljs-attr\"\u003E&quot;license&quot;\u003C\u002Fspan\u003E: \u003Cspan class=\"hljs-string\"\u003E&quot;ISC&quot;\u003C\u002Fspan\u003E,\n  \u003Cspan class=\"hljs-attr\"\u003E&quot;dependencies&quot;\u003C\u002Fspan\u003E: {\n    \u003Cspan class=\"hljs-attr\"\u003E&quot;discord.js&quot;\u003C\u002Fspan\u003E: \u003Cspan class=\"hljs-string\"\u003E&quot;^11.5.1&quot;\u003C\u002Fspan\u003E,\n    \u003Cspan class=\"hljs-attr\"\u003E&quot;dotenv&quot;\u003C\u002Fspan\u003E: \u003Cspan class=\"hljs-string\"\u003E&quot;^8.2.0&quot;\u003C\u002Fspan\u003E\n  }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EThen run \u003Ccode\u003Enpm install\u003C\u002Fcode\u003E to install the two defined dependencies, \u003Ccode\u003Ediscord.js\u003C\u002Fcode\u003E and \u003Ccode\u003Edotenv\u003C\u002Fcode\u003E. \u003Ccode\u003Edotenv\u003C\u002Fcode\u003E is going to help us keep our token private.\u003C\u002Fp\u003E\n\u003Cp\u003ENext create a file called \u003Ccode\u003E.env\u003C\u002Fcode\u003E and add your token into it:\u003C\u002Fp\u003E\n\u003Cdiv id=\"codeSnippet\"\u003E\n\n\u003Cpre class='language-javascriptreact'\u003E\u003Ccode\u003E\u003Cspan class=\"hljs-string\"\u003ETOKEN=&#x27;Your\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-string\"\u003EToken&#x27;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EI would create a \u003Ccode\u003E.gitignore\u003C\u002Fcode\u003E file now too and make sure to add \u003Ccode\u003E.env\u003C\u002Fcode\u003E to it, just so you don&#39;t forget!\u003C\u002Fp\u003E\n\u003Cp\u003ENow we can create the bot. You may have noticed in the \u003Ccode\u003Epackage.json\u003C\u002Fcode\u003E file we defined \u003Ccode\u003Emain\u003C\u002Fcode\u003E as \u003Ccode\u003Eindex.js\u003C\u002Fcode\u003E. That is the entrypoint for npm, so we should create an \u003Ccode\u003Eindex.js\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\n\u003Cdiv id=\"codeSnippet\"\u003E\n\n\u003Cpre class='language-javascriptreact'\u003E\u003Ccode\u003E\u003Cspan class=\"hljs-built_in\"\u003Erequire\u003C\u002Fspan\u003E(\u003Cspan class=\"hljs-string\"\u003E&#x27;dotenv&#x27;\u003C\u002Fspan\u003E).config();\n\u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E Discord = \u003Cspan class=\"hljs-built_in\"\u003Erequire\u003C\u002Fspan\u003E(\u003Cspan class=\"hljs-string\"\u003E&#x27;discord.js&#x27;\u003C\u002Fspan\u003E);\n\u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E bot = \u003Cspan class=\"hljs-keyword\"\u003Enew\u003C\u002Fspan\u003E Discord.Client();\nbot.commands = \u003Cspan class=\"hljs-keyword\"\u003Enew\u003C\u002Fspan\u003E Discord.Collection();\n\u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E botCommands = \u003Cspan class=\"hljs-built_in\"\u003Erequire\u003C\u002Fspan\u003E(\u003Cspan class=\"hljs-string\"\u003E&#x27;.\u002Fcommands&#x27;\u003C\u002Fspan\u003E);\n\n\u003Cspan class=\"hljs-built_in\"\u003EObject\u003C\u002Fspan\u003E.keys(botCommands).map(\u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-params\"\u003Ekey\u003C\u002Fspan\u003E =&gt;\u003C\u002Fspan\u003E {\n  bot.commands.set(botCommands[key].name, botCommands[key]);\n});\n\n\u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E TOKEN = process.env.TOKEN;\n\nbot.login(TOKEN);\n\nbot.on(\u003Cspan class=\"hljs-string\"\u003E&#x27;ready&#x27;\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-function\"\u003E() =&gt;\u003C\u002Fspan\u003E {\n  \u003Cspan class=\"hljs-built_in\"\u003Econsole\u003C\u002Fspan\u003E.info(\u003Cspan class=\"hljs-string\"\u003E`Logged in as \u003Cspan class=\"hljs-subst\"\u003E${bot.user.tag}\u003C\u002Fspan\u003E!`\u003C\u002Fspan\u003E);\n});\n\nbot.on(\u003Cspan class=\"hljs-string\"\u003E&#x27;message&#x27;\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-params\"\u003Emsg\u003C\u002Fspan\u003E =&gt;\u003C\u002Fspan\u003E {\n  \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E args = msg.content.split(\u003Cspan class=\"hljs-regexp\"\u003E\u002F +\u002F\u003C\u002Fspan\u003E);\n  \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E command = args.shift().toLowerCase();\n  \u003Cspan class=\"hljs-built_in\"\u003Econsole\u003C\u002Fspan\u003E.info(\u003Cspan class=\"hljs-string\"\u003E`Called command: \u003Cspan class=\"hljs-subst\"\u003E${command}\u003C\u002Fspan\u003E`\u003C\u002Fspan\u003E);\n\n  \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (!bot.commands.has(command)) \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E;\n\n  \u003Cspan class=\"hljs-keyword\"\u003Etry\u003C\u002Fspan\u003E {\n    bot.commands.get(command).execute(msg, args);\n  } \u003Cspan class=\"hljs-keyword\"\u003Ecatch\u003C\u002Fspan\u003E (error) {\n    \u003Cspan class=\"hljs-built_in\"\u003Econsole\u003C\u002Fspan\u003E.error(error);\n    msg.reply(\u003Cspan class=\"hljs-string\"\u003E&#x27;there was an error trying to execute that command!&#x27;\u003C\u002Fspan\u003E);\n  }\n});\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EThis code uses the \u003Ccode\u003Ediscord.js\u003C\u002Fcode\u003E plugin to create a Discord client, then logs in using the token. It then creates a collection and populates it with commands from the \u003Ccode\u003E\u002Fcommands\u003C\u002Fcode\u003E folder (which doesn&#39;t exist yet but we are getting there). Once the bot is ready it will log a message saying it is logged in. The below code is where the message handling happens:\u003C\u002Fp\u003E\n\u003Cdiv id=\"codeSnippet\"\u003E\n\n\u003Cpre class='language-javascriptreact'\u003E\u003Ccode\u003Ebot.on(\u003Cspan class=\"hljs-string\"\u003E&#x27;message&#x27;\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-params\"\u003Emsg\u003C\u002Fspan\u003E =&gt;\u003C\u002Fspan\u003E {\n  \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E args = msg.content.split(\u003Cspan class=\"hljs-regexp\"\u003E\u002F +\u002F\u003C\u002Fspan\u003E);\n  \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E command = args.shift().toLowerCase();\n  \u003Cspan class=\"hljs-built_in\"\u003Econsole\u003C\u002Fspan\u003E.info(\u003Cspan class=\"hljs-string\"\u003E`Called command: \u003Cspan class=\"hljs-subst\"\u003E${command}\u003C\u002Fspan\u003E`\u003C\u002Fspan\u003E);\n\n  \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (!bot.commands.has(command)) \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E;\n\n  \u003Cspan class=\"hljs-keyword\"\u003Etry\u003C\u002Fspan\u003E {\n    bot.commands.get(command).execute(msg, args);\n  } \u003Cspan class=\"hljs-keyword\"\u003Ecatch\u003C\u002Fspan\u003E (error) {\n    \u003Cspan class=\"hljs-built_in\"\u003Econsole\u003C\u002Fspan\u003E.error(error);\n    msg.reply(\u003Cspan class=\"hljs-string\"\u003E&#x27;there was an error trying to execute that command!&#x27;\u003C\u002Fspan\u003E);\n  }\n});\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EIt checks every message and separates by space into individual words, it then checks the first word to see if it is a command. If not it just does nothing. If so it tries to execute the command, and logs any errors.\u003C\u002Fp\u003E\n\u003Cp\u003ENow we should add the commands to make it actually do stuff. Create a folder called commands, and inside create \u003Ccode\u003Eindex.js\u003C\u002Fcode\u003E and \u003Ccode\u003Epromote.js\u003C\u002Fcode\u003E. \u003Ccode\u003Epromote.js\u003C\u002Fcode\u003E is my command so that can be whatever you want. Inside \u003Ccode\u003Epromote.js\u003C\u002Fcode\u003E put the following code:\u003C\u002Fp\u003E\n\u003Cdiv id=\"codeSnippet\"\u003E\n\n\u003Cpre class='language-javascriptreact'\u003E\u003Ccode\u003E\u003Cspan class=\"hljs-built_in\"\u003Emodule\u003C\u002Fspan\u003E.exports = {\n    \u003Cspan class=\"hljs-attr\"\u003Ename\u003C\u002Fspan\u003E: \u003Cspan class=\"hljs-string\"\u003E&#x27;promote&#x27;\u003C\u002Fspan\u003E,\n    \u003Cspan class=\"hljs-attr\"\u003Edescription\u003C\u002Fspan\u003E: \u003Cspan class=\"hljs-string\"\u003E&#x27;Promote Joshs Blog!&#x27;\u003C\u002Fspan\u003E,\n    execute(msg, args) {\n      \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E embed = {\n        \u003Cspan class=\"hljs-string\"\u003E&quot;title&quot;\u003C\u002Fspan\u003E: \u003Cspan class=\"hljs-string\"\u003E&quot;Joshs Blog&quot;\u003C\u002Fspan\u003E,\n        \u003Cspan class=\"hljs-string\"\u003E&quot;description&quot;\u003C\u002Fspan\u003E: \u003Cspan class=\"hljs-string\"\u003E&quot;My personal blog about Software Development, Sports, Music, and any more of my hobbies!&quot;\u003C\u002Fspan\u003E,\n        \u003Cspan class=\"hljs-string\"\u003E&quot;url&quot;\u003C\u002Fspan\u003E: \u003Cspan class=\"hljs-string\"\u003E&quot;https:\u002F\u002Fjoshglasson.com&quot;\u003C\u002Fspan\u003E,\n        \u003Cspan class=\"hljs-string\"\u003E&quot;color&quot;\u003C\u002Fspan\u003E: \u003Cspan class=\"hljs-built_in\"\u003EMath\u003C\u002Fspan\u003E.floor(\u003Cspan class=\"hljs-built_in\"\u003EMath\u003C\u002Fspan\u003E.random()*\u003Cspan class=\"hljs-number\"\u003E16777215\u003C\u002Fspan\u003E),\n        \u003Cspan class=\"hljs-string\"\u003E&quot;timestamp&quot;\u003C\u002Fspan\u003E: \u003Cspan class=\"hljs-built_in\"\u003EDate\u003C\u002Fspan\u003E.now()\n      };\n      msg.channel.send(\u003Cspan class=\"hljs-string\"\u003E&quot;Check out my blog here: &quot;\u003C\u002Fspan\u003E, { embed });\n    },\n};\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EAgain I have used the \u003Ca href=\"https:\u002F\u002Fleovoel.github.io\u002Fembed-visualizer\u002F\" target=\"_blank\"\u003Eembed visualiser\u003C\u002Fa\u003E here to get the embed code:\u003C\u002Fp\u003E\n\u003Cdiv id=\"imageDiv\"\u003E\n  \u003Cfigure\u003E\n    \u003Cimg src=\"https:\u002F\u002Fjoshlearningtocode.files.wordpress.com\u002F2020\u002F09\u002Fdiscord-bot-js-embed.png\" alt=\"JS Code to Embed a Link\"\u002F\u003E\n    \u003Cfigcaption\u003EJavaScript Code to Embed a Link\u003C\u002Ffigcaption\u003E\n  \u003C\u002Ffigure\u003E\n\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EI have once again changed the colour and timestamp to be dynamic.\u003C\u002Fp\u003E\n\u003Cp\u003EFinally in \u003Ccode\u003Ecommands\u002Findex.js\u003C\u002Fcode\u003E we need to add the below:\u003C\u002Fp\u003E\n\u003Cdiv id=\"codeSnippet\"\u003E\n\n\u003Cpre class='language-javascriptreact'\u003E\u003Ccode\u003E\u003Cspan class=\"hljs-built_in\"\u003Emodule\u003C\u002Fspan\u003E.exports = {\n    \u003Cspan class=\"hljs-attr\"\u003EPromote\u003C\u002Fspan\u003E: \u003Cspan class=\"hljs-built_in\"\u003Erequire\u003C\u002Fspan\u003E(\u003Cspan class=\"hljs-string\"\u003E&#x27;.\u002Fpromote&#x27;\u003C\u002Fspan\u003E),\n};\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EWe import any commands into this file, then import this file into the main \u003Ccode\u003Eindex.js\u003C\u002Fcode\u003E. This keeps it neater, as otherwise we would need to import each individual command into the main \u003Ccode\u003Eindex.js\u003C\u002Fcode\u003E file. We can now run the bot with \u003Ccode\u003Enode index.js\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\n\u003Cp\u003EHere is the working JS bot:\u003C\u002Fp\u003E\n\u003Cdiv id=\"imageDiv\"\u003E\n  \u003Cfigure\u003E\n    \u003Cimg src=\"https:\u002F\u002Fjoshlearningtocode.files.wordpress.com\u002F2020\u002F09\u002Fdiscord-bot-js-message.png\" alt=\"JS Bot Working in Discord\"\u002F\u003E\n    \u003Cfigcaption\u003EJS Bot Working in Discord\u003C\u002Ffigcaption\u003E\n  \u003C\u002Ffigure\u003E\n\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EAs you can see it works pretty much the same way. However the key difference is it doesn&#39;t take a prefix, which may lead to confusion as it could trigger when it shouldn&#39;t. I updated my code to ensure it only picks up words with the \u003Ccode\u003E?\u003C\u002Fcode\u003E prefix as it does in the Ruby version. The below is what I added to the \u003Ccode\u003Eon message\u003C\u002Fcode\u003E function in the main \u003Ccode\u003Eindex.js\u003C\u002Fcode\u003E, before the check for the command existing:\u003C\u002Fp\u003E\n\u003Cdiv id=\"codeSnippet\"\u003E\n\n\u003Cpre class='language-javascriptreact'\u003E\u003Ccode\u003E\u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (command.slice(\u003Cspan class=\"hljs-number\"\u003E0\u003C\u002Fspan\u003E,\u003Cspan class=\"hljs-number\"\u003E1\u003C\u002Fspan\u003E) != \u003Cspan class=\"hljs-string\"\u003E&#x27;?&#x27;\u003C\u002Fspan\u003E) {\n  \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E;\n} \u003Cspan class=\"hljs-keyword\"\u003Eelse\u003C\u002Fspan\u003E {\n  command = command.slice(\u003Cspan class=\"hljs-number\"\u003E1\u003C\u002Fspan\u003E)\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EHere it is in action\u003C\u002Fp\u003E\n\u003Cdiv id=\"imageDiv\"\u003E\n  \u003Cfigure\u003E\n    \u003Cimg src=\"https:\u002F\u002Fjoshlearningtocode.files.wordpress.com\u002F2020\u002F09\u002Fdiscord-bot-js-messages-with-prefix.gif\" alt=\"JS Bot\"\u002F\u003E\n  \u003C\u002Ffigure\u003E\n\u003C\u002Fdiv\u003E\n\n\u003Cp\u003ENow everything was working I added more info to my embed:\u003C\u002Fp\u003E\n\u003Cdiv id=\"imageDiv\"\u003E\n  \u003Cfigure\u003E\n    \u003Cimg src=\"https:\u002F\u002Fjoshlearningtocode.files.wordpress.com\u002F2020\u002F09\u002Fdiscord-bot-js-embed-with-images.png\" alt=\"JS Embed with Logo\"\u002F\u003E\n    \u003Cfigcaption\u003EJS Embed with Logo\u003C\u002Ffigcaption\u003E\n  \u003C\u002Ffigure\u003E\n\u003C\u002Fdiv\u003E\n\n\u003Cbr\u003E\n\n\u003Cp\u003EYou can find the \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FJoshGlasson\u002FDiscord-Bot\" target=\"_blank\"\u003Ecode on my GitHub\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EAnd that is it for now. I find little things like this very interesting, I may revisit this and add more to it in the future, so look out for a part 2 one day!\u003C\u002Fp\u003E\n\u003Cbr\u003E\n\n\u003Ch1\u003E\u003Cem\u003E\u003Cstrong\u003EUPDATE: Thu Sep 03 2020\u003C\u002Fstrong\u003E\u003C\u002Fem\u003E\u003C\u002Fh1\u003E\n\u003Ch2\u003E\u003Cem\u003E\u003Cstrong\u003EAdding Python\u003C\u002Fstrong\u003E\u003C\u002Fem\u003E\u003C\u002Fh2\u003E\n\n\u003Cbr\u003E\n\n\u003Ch1 id=\"python\"\u003EPython\u003C\u002Fh1\u003E\n\u003Ch2 id=\"register-the-bot\"\u003ERegister the Bot\u003C\u002Fh2\u003E\n\u003Cp\u003EAgain we need to have a bot setup and an auth token ready to use. Follow the setup process in the Ruby guide for this if you haven&#39;t done it already, and then follow the guide in the JavaScript section to add it to your server.\u003C\u002Fp\u003E\n\u003Ch2 id=\"project-setup-2\"\u003EProject Setup\u003C\u002Fh2\u003E\n\u003Cp\u003EDespite having PyCharm installed, I decided to stick with VSCode for the Python code. It actually works pretty well, well enough for the simple project I am going to be doing anyway! If you too want to use VSCode, I would follow \u003Ca href=\"https:\u002F\u002Fcode.visualstudio.com\u002Fdocs\u002Fpython\u002Fpython-tutorial\" target=\"_blank\"\u003Ethis guide\u003C\u002Fa\u003E to get it setup for Python.\u003C\u002Fp\u003E\n\u003Cp\u003ENow the IDE is setup we can start on the project. I was following \u003Ca href=\"https:\u002F\u002Fwww.devdungeon.com\u002Fcontent\u002Fmake-discord-bot-python\" target=\"_blank\"\u003Ethis guide\u003C\u002Fa\u003E to start with, but ran into all sorts of problems with python, so will try to explain exactly what I did.\u003C\u002Fp\u003E\n\u003Cp\u003EFirstly we need the \u003Ccode\u003Ediscord.py\u003C\u002Fcode\u003E library. There are some issues with this library working on the newest version of python, so use the below commands to get it working:\u003C\u002Fp\u003E\n\u003Cdiv id=\"codeSnippet\"\u003E\n\n\u003Cpre class='language-javascriptreact'\u003E\u003Ccode\u003Epython3 -m pip install -U \u003Cspan class=\"hljs-string\"\u003E&quot;https:\u002F\u002Fgithub.com\u002FRapptz\u002Fdiscord.py\u002Farchive\u002Fasync.zip#egg=discord.py[voice]&quot;\u003C\u002Fspan\u003E\npython3 -m pip install --upgrade aiohttp\npython3 -m pip install --upgrade websockets\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EI am not sure the second and third commands are necessary, but it worked for me! Now we can get started, so in your project folder, create a file called \u003Ccode\u003Ebot.py\u003C\u002Fcode\u003E and add the following code:\u003C\u002Fp\u003E\n\u003Cdiv id=\"codeSnippet\"\u003E\n\n\u003Cpre class='language-javascriptreact'\u003E\u003Ccode\u003E\u003Cspan class=\"hljs-keyword\"\u003Eimport\u003C\u002Fspan\u003E discord\n\nTOKEN = \u003Cspan class=\"hljs-string\"\u003E&#x27;PUT YOUR TOKEN HERE&#x27;\u003C\u002Fspan\u003E\n\nclient = discord.Client()\n\n\u003Cspan class=\"hljs-meta\"\u003E@client.event\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-keyword\"\u003Easync\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Edef\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003Eon_message\u003C\u002Fspan\u003E(\u003Cspan class=\"hljs-params\"\u003Emessage\u003C\u002Fspan\u003E):\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-comment\"\u003E# we do not want the bot to reply to itself\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E message.author == client.user:\n        \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E\n\n    \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E message.content.startswith(\u003Cspan class=\"hljs-string\"\u003E&#x27;!hello&#x27;\u003C\u002Fspan\u003E):\n        msg = \u003Cspan class=\"hljs-string\"\u003E&#x27;Hello {0.author.mention}&#x27;\u003C\u002Fspan\u003E.format(message)\n        \u003Cspan class=\"hljs-keyword\"\u003Eawait\u003C\u002Fspan\u003E client.send_message(message.channel, msg)\n\n\u003Cspan class=\"hljs-meta\"\u003E@client.event\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-keyword\"\u003Easync\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Edef\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003Eon_ready\u003C\u002Fspan\u003E():\u003C\u002Fspan\u003E\n    print(\u003Cspan class=\"hljs-string\"\u003E&#x27;Logged in as&#x27;\u003C\u002Fspan\u003E)\n    print(client.user.name)\n    print(client.user.id)\n    print(\u003Cspan class=\"hljs-string\"\u003E&#x27;------&#x27;\u003C\u002Fspan\u003E)\n\nclient.run(TOKEN)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EAfter adding your token, try to run this python file in the terminal using \u003Ccode\u003Epython3 \u002Fpath\u002Fto\u002Ffile\u002Fbot.py\u003C\u002Fcode\u003E (or the play button in the top right in VSCode).\u003C\u002Fp\u003E\n\u003Cp\u003EAt this point you may run into an SSLError, something like this will be in the stack trace.\u003C\u002Fp\u003E\n\u003Cdiv id=\"codeSnippet\"\u003E\n\n\u003Cpre class='language-javascriptreact'\u003E\u003Ccode\u003ECannot connect to host discordapp.com:443 ssl:True \n[SSLCertVerificationError: (1, \u003Cspan class=\"hljs-string\"\u003E&#x27;[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:1056)&#x27;\u003C\u002Fspan\u003E)]\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EIf this does happen to you, navigate to your root directory, then go to \u003Ccode\u003EApplications\u002FPython 3.7\u003C\u002Fcode\u003E and run the \u003Ccode\u003EInstall Certificates.command\u003C\u002Fcode\u003E file. Now if you re-run the python script, it should work!\u003C\u002Fp\u003E\n\u003Cp\u003EYou should be able to see your bot in your channel, and sending \u003Ccode\u003E!hello\u003C\u002Fcode\u003E should prompt it to reply and tag you in the response.\u003C\u002Fp\u003E\n\u003Cdiv id=\"imageDiv\"\u003E\n  \u003Cfigure\u003E\n    \u003Cimg src=\"https:\u002F\u002Fjoshlearningtocode.files.wordpress.com\u002F2020\u002F09\u002Fdiscord-bot-py-hello.png\" alt=\"Python Bot Hello\"\u002F\u003E\n    \u003Cfigcaption\u003EPython Bot Hello\u003C\u002Ffigcaption\u003E\n  \u003C\u002Ffigure\u003E\n\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EThe bot is up and running now, so we can make some more tweaks. Instead of hardcoding my token into the \u003Ccode\u003Ebot.py\u003C\u002Fcode\u003E file, I want to use \u003Ccode\u003Edotenv\u003C\u002Fcode\u003E as I have for my JavaScript bot. I installed the plugin with \u003Ccode\u003Epython3 -m pip install python-dotenv\u003C\u002Fcode\u003E, and created a \u003Ccode\u003E.env\u003C\u002Fcode\u003E file with my token inside, in a key value pair format. For example \u003Ccode\u003ETOKEN=&quot;My token&quot;\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\n\u003Cp\u003ETo get this into my \u003Ccode\u003Ebot.py\u003C\u002Fcode\u003E file, I had to add a few things at the top:\u003C\u002Fp\u003E\n\u003Cdiv id=\"codeSnippet\"\u003E\n\n\u003Cpre class='language-javascriptreact'\u003E\u003Ccode\u003E\u003Cspan class=\"hljs-keyword\"\u003Eimport\u003C\u002Fspan\u003E discord\n\u003Cspan class=\"hljs-keyword\"\u003Efrom\u003C\u002Fspan\u003E dotenv \u003Cspan class=\"hljs-keyword\"\u003Eimport\u003C\u002Fspan\u003E load_dotenv\n\u003Cspan class=\"hljs-keyword\"\u003Eimport\u003C\u002Fspan\u003E os\n\nload_dotenv()\nTOKEN = os.environ.get(\u003Cspan class=\"hljs-string\"\u003E&#x27;TOKEN&#x27;\u003C\u002Fspan\u003E)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\n\u003Cp\u003ENext I wanted to update my code to look for the \u003Ccode\u003E?\u003C\u002Fcode\u003E prefix, as it has in the other two projects. To do this I added another \u003Ccode\u003Eif\u003C\u002Fcode\u003E block after the check that the bot is not replying to itself:\u003C\u002Fp\u003E\n\u003Cdiv id=\"codeSnippet\"\u003E\n\n\u003Cpre class='language-javascriptreact'\u003E\u003Ccode\u003E\u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E message.content.startswith(\u003Cspan class=\"hljs-string\"\u003E&#x27;?&#x27;\u003C\u002Fspan\u003E):\n    command = message.content[\u003Cspan class=\"hljs-number\"\u003E1\u003C\u002Fspan\u003E:]\n    print(\u003Cspan class=\"hljs-string\"\u003E&quot;Command received: &quot;\u003C\u002Fspan\u003E + command)\n\u003Cspan class=\"hljs-keyword\"\u003Eelse\u003C\u002Fspan\u003E:\n    print(\u003Cspan class=\"hljs-string\"\u003E&quot;Commands should start with ?&quot;\u003C\u002Fspan\u003E)\n    \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EIf a message starts with \u003Ccode\u003E?\u003C\u002Fcode\u003E, then I trim the message to not include the \u003Ccode\u003E?\u003C\u002Fcode\u003E and save that into my \u003Ccode\u003Ecommand\u003C\u002Fcode\u003E variable. If it does not start with \u003Ccode\u003E?\u003C\u002Fcode\u003E I print a log then \u003Ccode\u003Ereturn\u003C\u002Fcode\u003E, so none of the rest of the code after this point is executed.\u003C\u002Fp\u003E\n\u003Cp\u003ENow I could add the \u003Ccode\u003Epromote\u003C\u002Fcode\u003E command I have been working with on the other projects.\u003C\u002Fp\u003E\n\u003Cdiv id=\"codeSnippet\"\u003E\n\n\u003Cpre class='language-javascriptreact'\u003E\u003Ccode\u003E\u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E command.startswith(\u003Cspan class=\"hljs-string\"\u003E&#x27;promote&#x27;\u003C\u002Fspan\u003E):\n  colour=random.randint(\u003Cspan class=\"hljs-number\"\u003E0\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-number\"\u003E0xFFFFFF\u003C\u002Fspan\u003E)\n  embed = discord.Embed(title=\u003Cspan class=\"hljs-string\"\u003E&quot;Joshs Blog&quot;\u003C\u002Fspan\u003E, colour=discord.Colour(colour), url=\u003Cspan class=\"hljs-string\"\u003E&quot;https:\u002F\u002Fjoshglasson.com&quot;\u003C\u002Fspan\u003E, description=\u003Cspan class=\"hljs-string\"\u003E&quot;My personal blog about Software Development, Sports, Music, and any more of my hobbies!&quot;\u003C\u002Fspan\u003E, timestamp=datetime.utcnow())\n  embed.set_image(url=\u003Cspan class=\"hljs-string\"\u003E&quot;https:\u002F\u002Fjoshglasson.com\u002Flogo.png&quot;\u003C\u002Fspan\u003E)\n  embed.set_thumbnail(url=\u003Cspan class=\"hljs-string\"\u003E&quot;https:\u002F\u002Fjoshglasson.com\u002Flogo.png&quot;\u003C\u002Fspan\u003E)\n  embed.set_author(name=\u003Cspan class=\"hljs-string\"\u003E&quot;Josh Glasson&quot;\u003C\u002Fspan\u003E, url=\u003Cspan class=\"hljs-string\"\u003E&quot;https:\u002F\u002Fjoshglasson.com&quot;\u003C\u002Fspan\u003E, icon_url=\u003Cspan class=\"hljs-string\"\u003E&quot;https:\u002F\u002Fjoshglasson.com\u002Flogo.png&quot;\u003C\u002Fspan\u003E)\n  \u003Cspan class=\"hljs-keyword\"\u003Eawait\u003C\u002Fspan\u003E client.send_message(message.channel, embed=embed)\n  print(\u003Cspan class=\"hljs-string\"\u003E&quot;Command executed: &quot;\u003C\u002Fspan\u003E + command)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EOnce again I am picking a random colour and setting the time to now. To do this I used \u003Ccode\u003Erandom\u003C\u002Fcode\u003E and \u003Ccode\u003Edatetime\u003C\u002Fcode\u003E, both of which have to be imported. I used the embed visualiser to get the right code for embedding, although had to tweek some bits to make it work with my bot.\u003C\u002Fp\u003E\n\u003Cdiv id=\"imageDiv\"\u003E\n  \u003Cfigure\u003E\n    \u003Cimg src=\"https:\u002F\u002Fjoshlearningtocode.files.wordpress.com\u002F2020\u002F09\u002Fdiscord-bot-python-visualizer.png\" alt=\"Python Embed Visualiser\"\u002F\u003E\n    \u003Cfigcaption\u003EPython Embed Visualiser\u003C\u002Ffigcaption\u003E\n  \u003C\u002Ffigure\u003E\n\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EHere is the full \u003Ccode\u003Ebot.py\u003C\u002Fcode\u003E code:\u003C\u002Fp\u003E\n\u003Cdiv id=\"codeSnippet\"\u003E\n\n\u003Cpre class='language-javascriptreact'\u003E\u003Ccode\u003E\u003Cspan class=\"hljs-keyword\"\u003Eimport\u003C\u002Fspan\u003E discord\n\u003Cspan class=\"hljs-keyword\"\u003Efrom\u003C\u002Fspan\u003E datetime \u003Cspan class=\"hljs-keyword\"\u003Eimport\u003C\u002Fspan\u003E datetime\n\u003Cspan class=\"hljs-keyword\"\u003Eimport\u003C\u002Fspan\u003E random\n\u003Cspan class=\"hljs-keyword\"\u003Efrom\u003C\u002Fspan\u003E dotenv \u003Cspan class=\"hljs-keyword\"\u003Eimport\u003C\u002Fspan\u003E load_dotenv\n\u003Cspan class=\"hljs-keyword\"\u003Eimport\u003C\u002Fspan\u003E os\n\nload_dotenv()\nTOKEN = os.environ.get(\u003Cspan class=\"hljs-string\"\u003E&#x27;TOKEN&#x27;\u003C\u002Fspan\u003E)\n\nclient = discord.Client()\n\n\u003Cspan class=\"hljs-meta\"\u003E@client.event\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-keyword\"\u003Easync\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Edef\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003Eon_message\u003C\u002Fspan\u003E(\u003Cspan class=\"hljs-params\"\u003Emessage\u003C\u002Fspan\u003E):\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-comment\"\u003E# we do not want the bot to reply to itself\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E message.author == client.user:\n        \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E\n\n    \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E message.content.startswith(\u003Cspan class=\"hljs-string\"\u003E&#x27;?&#x27;\u003C\u002Fspan\u003E):\n        command = message.content[\u003Cspan class=\"hljs-number\"\u003E1\u003C\u002Fspan\u003E:]\n        print(\u003Cspan class=\"hljs-string\"\u003E&quot;Command received: &quot;\u003C\u002Fspan\u003E + command)\n    \u003Cspan class=\"hljs-keyword\"\u003Eelse\u003C\u002Fspan\u003E:\n        print(\u003Cspan class=\"hljs-string\"\u003E&quot;Commands should start with ?&quot;\u003C\u002Fspan\u003E)\n        \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E\n\n    \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E command.startswith(\u003Cspan class=\"hljs-string\"\u003E&#x27;hello&#x27;\u003C\u002Fspan\u003E):\n        msg = \u003Cspan class=\"hljs-string\"\u003E&#x27;Hello {0.author.mention}&#x27;\u003C\u002Fspan\u003E.format(message)\n        \u003Cspan class=\"hljs-keyword\"\u003Eawait\u003C\u002Fspan\u003E client.send_message(message.channel, msg)\n        print(\u003Cspan class=\"hljs-string\"\u003E&quot;Command executed: &quot;\u003C\u002Fspan\u003E + command)\n        \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E\n\n    \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E command.startswith(\u003Cspan class=\"hljs-string\"\u003E&#x27;promote&#x27;\u003C\u002Fspan\u003E):\n        colour=random.randint(\u003Cspan class=\"hljs-number\"\u003E0\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-number\"\u003E0xFFFFFF\u003C\u002Fspan\u003E)\n        embed = discord.Embed(title=\u003Cspan class=\"hljs-string\"\u003E&quot;Joshs Blog&quot;\u003C\u002Fspan\u003E, colour=discord.Colour(colour), url=\u003Cspan class=\"hljs-string\"\u003E&quot;https:\u002F\u002Fjoshglasson.com&quot;\u003C\u002Fspan\u003E, description=\u003Cspan class=\"hljs-string\"\u003E&quot;My personal blog about Software Development, Sports, Music, and any more of my hobbies!&quot;\u003C\u002Fspan\u003E, timestamp=datetime.utcnow())\n        embed.set_image(url=\u003Cspan class=\"hljs-string\"\u003E&quot;https:\u002F\u002Fjoshglasson.com\u002Flogo.png&quot;\u003C\u002Fspan\u003E)\n        embed.set_thumbnail(url=\u003Cspan class=\"hljs-string\"\u003E&quot;https:\u002F\u002Fjoshglasson.com\u002Flogo.png&quot;\u003C\u002Fspan\u003E)\n        embed.set_author(name=\u003Cspan class=\"hljs-string\"\u003E&quot;Josh Glasson&quot;\u003C\u002Fspan\u003E, url=\u003Cspan class=\"hljs-string\"\u003E&quot;https:\u002F\u002Fjoshglasson.com&quot;\u003C\u002Fspan\u003E, icon_url=\u003Cspan class=\"hljs-string\"\u003E&quot;https:\u002F\u002Fjoshglasson.com\u002Flogo.png&quot;\u003C\u002Fspan\u003E)\n        \u003Cspan class=\"hljs-keyword\"\u003Eawait\u003C\u002Fspan\u003E client.send_message(message.channel, embed=embed)\n        print(\u003Cspan class=\"hljs-string\"\u003E&quot;Command executed: &quot;\u003C\u002Fspan\u003E + command)\n        \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E\n\n    print(\u003Cspan class=\"hljs-string\"\u003E&quot;Command &quot;\u003C\u002Fspan\u003E + command + \u003Cspan class=\"hljs-string\"\u003E&quot; does not match any known commands&quot;\u003C\u002Fspan\u003E)\n\n\u003Cspan class=\"hljs-meta\"\u003E@client.event\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-keyword\"\u003Easync\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Edef\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003Eon_ready\u003C\u002Fspan\u003E():\u003C\u002Fspan\u003E\n    print(\u003Cspan class=\"hljs-string\"\u003E&#x27;Logged in as&#x27;\u003C\u002Fspan\u003E)\n    print(client.user.name)\n    print(client.user.id)\n    print(\u003Cspan class=\"hljs-string\"\u003E&#x27;------&#x27;\u003C\u002Fspan\u003E)\n\nclient.run(TOKEN)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EAnd here it is in action:\u003C\u002Fp\u003E\n\u003Cdiv id=\"imageDiv\"\u003E\n  \u003Cfigure\u003E\n    \u003Cimg src=\"https:\u002F\u002Fjoshlearningtocode.files.wordpress.com\u002F2020\u002F09\u002Fdiscord-bot-python.png\" alt=\"Python Bot\"\u002F\u003E\n    \u003Cfigcaption\u003EPython Bot\u003C\u002Ffigcaption\u003E\n  \u003C\u002Ffigure\u003E\n\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EYou may have spotted the timestamp on the embed and the actual time are an hour apart. That is because I was using \u003Ccode\u003Edatetime.now()\u003C\u002Fcode\u003E which was returning the time in BST, however Discord was expecting UTC and tried to convert it to BST again for me, hence it becomes an hour ahead of what it should be. I have updated the code above to use \u003Ccode\u003Edatetime.utcnow()\u003C\u002Fcode\u003E which fixes this problem!\u003C\u002Fp\u003E\n\u003Cp\u003EAs with before the \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FJoshGlasson\u002FDiscord-Bot\" target=\"_blank\"\u003Ecode is on my GitHub\u003C\u002Fa\u003E if you want to check it out.\u003C\u002Fp\u003E\n",slug:e,title:f,headline:g,image:h,sortdate:d,originaldate:i,tags:[c]},posts:{posts:[{slug:"f1_2020_tuscan_gp",title:"F1 Recap - Tuscan Grand Prix 2020.",headline:"2 Red Flags on Another Crazy Day in Italy",image:a,sortdate:j,originaldate:j,tags:[b]},{slug:"f1_2020_italian_gp",title:"F1 Recap - Italian Grand Prix 2020.",headline:"Gasly gets his first race win",image:a,sortdate:k,originaldate:k,tags:[b]},{slug:"super_mario_35th_anniversary_direct",title:"Super Mario Bros. 35th Anniversary Nintendo Direct.",headline:"All the announcements from the special Nintendo Direct",image:".\u002Fimages\u002Ficons\u002FSMB 35.png",sortdate:d,originaldate:d,tags:["Gaming"]},{slug:e,title:f,headline:g,image:h,sortdate:d,originaldate:i,tags:[c]},{slug:"f1_2020_belgian_gp",title:"F1 Recap - Belgian Grand Prix 2020.",headline:"Daniel Ricciardo puts in a great performance to finish 4th",image:a,sortdate:l,originaldate:l,tags:[b]},{slug:"f1_2020_spanish_gp",title:"F1 Recap - Spanish Grand Prix 2020.",headline:"Another dominant performance from Lewis Hamilton",image:a,sortdate:m,originaldate:m,tags:[b]},{slug:"embedding_tweets",title:"Embedding Tweets In Svelte Blog Posts.",headline:"Reliably embed tweets in blog posts when using Svelte and Sapper",image:".\u002Fimages\u002Fabout\u002Ftwitter_logo.png",sortdate:n,originaldate:n,tags:[c,o,p]},{slug:"f1_2020_70th_anniversary_gp",title:"F1 Recap - 70th Anniversary Grand Prix 2020.",headline:"Brilliant strategy leads to Red Bull win",image:a,sortdate:q,originaldate:q,tags:[b]},{slug:"kanye_west_albums_ranked",title:"Ranking Every Kanye West Album.",headline:"My ranking of all of Kanye West's released albums",image:".\u002Fimages\u002Ficons\u002Fkanye bear.png",sortdate:r,originaldate:r,tags:["Music"]},{slug:"f1_2020_silverstone",title:"F1 Recap - Silverstone 2020.",headline:"Hamilton hangs on to victory",image:a,sortdate:s,originaldate:s,tags:[b]},{slug:"useful_tools",title:"Useful Tools.",headline:"Tools I find useful as a Software Dev",image:".\u002Fimages\u002Ficons\u002Ftools.png",sortdate:"2020-07-31",originaldate:"2020-07-30",tags:[c]},{slug:"creating_the_blog",title:"Creating This Blog.",headline:"How to create a blog using Svelte",image:".\u002Fimages\u002Ficons\u002Fsvelte_logo.png",sortdate:t,originaldate:t,tags:[c,o,p]},{slug:"test_blog",title:"Test Blog.",headline:"Testing out the blog and some features",image:".\u002Flogo.png",sortdate:u,originaldate:u,tags:[]}]}}}(".\u002Fimages\u002Ficons\u002Ff1 logo 2020.png","Formula 1","Software Development","2020-09-03","discord_bot","Creating a Simple Discord Bot.","Its not self promotion if its done by a robot!",".\u002Fimages\u002Ficons\u002Fdiscord logo.png","2020-09-02","2020-09-13","2020-09-06","2020-08-30","2020-08-16","2020-08-12","Svelte","HTML, CSS & JavaScript","2020-08-09","2020-08-07","2020-08-03","2020-07-24","2020-07-23"))]};if('serviceWorker' in navigator)navigator.serviceWorker.register('/service-worker.js');var s=document.createElement("script");try{new Function("if(0)import('')")();s.src="/client/client.bbf17715.js";s.type="module";s.crossOrigin="use-credentials";}catch(e){s.src="/client/shimport@1.0.1.js";s.setAttribute("data-main","/client/client.bbf17715.js")}document.head.appendChild(s)</script> 