<!doctype html> <html lang=en> <head> <meta charset=utf-8> <meta content="width=device-width,initial-scale=1" name=viewport> <meta content=#333333 name=theme-color> <script src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js async data-ad-client=ca-pub-1501125542619304></script> <base href=/ > <link href=global.css rel=stylesheet> <link href=manifest.json rel=manifest crossorigin=use-credentials> <link href=favicon.png rel=icon type=image/png> <link href=client/main.2048647487.css rel=stylesheet> <noscript id=sapper-head-start></noscript><title>Embedding Tweets In Svelte Blog Posts.</title><script data-svelte=svelte-eywh2g src="https://www.googletagmanager.com/gtag/js?id=G-TJ8JZX38E6" async></script><script data-svelte=svelte-eywh2g>window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'G-TJ8JZX38E6'); </script><script data-svelte=svelte-eywh2g src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js async data-ad-client=ca-pub-1501125542619304></script><script data-svelte=svelte-eywh2g src=https://platform.twitter.com/widgets.js id=twitter-wjs></script><link href=./photoswipe/photoswipe.css rel=stylesheet data-svelte=svelte-eywh2g><link href=./photoswipe/default-skin/default-skin.css rel=stylesheet data-svelte=svelte-eywh2g><script data-svelte=svelte-eywh2g src=./photoswipe/photoswipe.min.js></script><script data-svelte=svelte-eywh2g src=./photoswipe/photoswipe-ui-default.min.js></script><meta content=summary data-svelte=svelte-btz695 name=twitter:card><meta content=@joshglasson data-svelte=svelte-btz695 name=twitter:site><meta content=@joshglasson data-svelte=svelte-btz695 name=twitter:creator><meta content="Embedding Tweets In Svelte Blog Posts." data-svelte=svelte-btz695 property=og:title><meta content=https://joshglasson.co.uk/images/about/twitter_logo.png data-svelte=svelte-btz695 property=og:image><meta content="Reliably embed tweets in blog posts when using Svelte and Sapper" data-svelte=svelte-btz695 property=og:description><meta content=https://joshglasson.co.uk/blog/2020-08-12-embedding_tweets data-svelte=svelte-btz695 property=og:url><noscript id=sapper-head-end></noscript> </head> <body> <div id=sapper> blog; <nav class=svelte-gj03cv id=navbar><ul class=svelte-gj03cv><li class=svelte-gj03cv><a href=/ class=svelte-gj03cv>home</a></li> <li class=svelte-gj03cv><a href=about class=svelte-gj03cv>about</a></li> <li class=svelte-gj03cv><a href=blog class=svelte-gj03cv aria-current=blog rel=prefetch>blog</a></li> <li class=svelte-gj03cv><a class=svelte-gj03cv>dark mode</a></ul></nav> <main class=svelte-u6q2x9> <div class="svelte-2ne1xb postTitle"><h1 class=svelte-2ne1xb>Embedding Tweets In Svelte Blog Posts.</h1> <h2 class=svelte-2ne1xb><strong>Reliably embed tweets in blog posts when using Svelte and Sapper</strong></h2></div> <div class="svelte-2ne1xb date"><h3><i>Originally posted on Wed Aug 12 2020</i></h3></div> <div class="svelte-2ne1xb readTime"></div> <div class="svelte-2ne1xb content"><p>I have embedded a few tweets in my recent blog posts, you can see examples <a href=https://joshglasson.com/blog/f1_2020_70th_anniversary_gp target=_blank>here in my last F1 recap</a>.</p> <p>Originally I was using Twitter's built in embed functionality. If you click the embed option on a tweet, you get taken to another page which provides some code for you to use. Here is an example of this code:</p> <div id=codeSnippet> <pre class=language-javascriptreact><code><span class=hljs-tag>&lt;<span class=hljs-name>blockquote</span> <span class=hljs-attr>class</span>=<span class=hljs-string>"twitter-tweet"</span>></span><span class=hljs-tag>&lt;<span class=hljs-name>p</span> <span class=hljs-attr>lang</span>=<span class=hljs-string>"en"</span> <span class=hljs-attr>dir</span>=<span class=hljs-string>"ltr"</span>></span>Max<span class=hljs-symbol>&amp#39;</span>s grandma is probably pretty fast though, right?!? ðŸ‘µ ðŸš€<span class=hljs-tag>&lt;<span class=hljs-name>a</span> <span class=hljs-attr>href</span>=<span class=hljs-string>"https://twitter.com/hashtag/F170?src=hash<span class=hljs-symbol>&ampamp;</span>ref_src=twsrc%5Etfw"</span>></span>#F170<span class=hljs-tag>&lt;/<span class=hljs-name>a</span>></span> ðŸ‡¬ðŸ‡§ <span class=hljs-tag>&lt;<span class=hljs-name>a</span> <span class=hljs-attr>href</span>=<span class=hljs-string>"https://twitter.com/hashtag/F1?src=hash<span class=hljs-symbol>&ampamp;</span>ref_src=twsrc%5Etfw"</span>></span>#F1<span class=hljs-tag>&lt;/<span class=hljs-name>a</span>></span> <span class=hljs-tag>&lt;<span class=hljs-name>a</span> <span class=hljs-attr>href</span>=<span class=hljs-string>"https://t.co/c0CpuE3iGE"</span>></span>pic.twitter.com/c0CpuE3iGE<span class=hljs-tag>&lt;/<span class=hljs-name>a</span>></span><span class=hljs-tag>&lt;/<span class=hljs-name>p</span>></span><span class=hljs-symbol>&ampmdash;</span> Formula 1 (@F1) <span class=hljs-tag>&lt;<span class=hljs-name>a</span> <span class=hljs-attr>href</span>=<span class=hljs-string>"https://twitter.com/F1/status/1292573366981816320?ref_src=twsrc%5Etfw"</span>></span>August 9, 2020<span class=hljs-tag>&lt;/<span class=hljs-name>a</span>></span><span class=hljs-tag>&lt;/<span class=hljs-name>blockquote</span>></span> <span class=hljs-tag>&lt;<span class=hljs-name>script</span> <span class=hljs-attr>async</span> <span class=hljs-attr>src</span>=<span class=hljs-string>"https://platform.twitter.com/widgets.js"</span> <span class=hljs-attr>charset</span>=<span class=hljs-string>"utf-8"</span>></span><span class=hljs-tag>&lt;/<span class=hljs-name>script</span>></span> </code></pre></div> <div id=imageDiv> <figure> <img alt="Embed option on Tweet" src=https://joshlearningtocode.files.wordpress.com/2020/08/screenshot-2020-08-12-at-11.33.43.png> <figcaption>Embed option on Tweet</figcaption> </figure> <figure> <img alt="Twitter Embed Website" src=https://joshlearningtocode.files.wordpress.com/2020/08/screenshot-2020-08-12-at-11.34.10.png> <figcaption>Twitter Embed Website</figcaption> </figure> </div> <p>I also added <code>tw-align-center</code> to make the tweet center itself in the div.</p> <div id=imageDiv> <figure> <img alt="Embedded Tweet" src=https://joshlearningtocode.files.wordpress.com/2020/08/embedded-tweet.png style=border-style:solid;border-color:#fff> <figcaption>Embedded Tweet</figcaption> </figure> </div> <p>I thought this worked fine, I could see the tweet loading and it was visible on the page. I added <code>data-theme: dark</code> to change the background colour of the tweet to be in dark mode too.</p> <p>The way it seemed to work was that the script Twitter included in the embed code would resolve the <code>blockquote</code> into a bunch of divs containing the content.</p> <p>I was happy with this, so I pushed it live. However once it was live, I was looking at it on my phone, and I noticed that most of the time the tweet would not load:</p> <div id=imageDiv> <figure> <img alt="Embedded Tweet Not Loading" src=https://joshlearningtocode.files.wordpress.com/2020/08/embedded-tweet-not-loading.png style=border-style:solid;border-color:#fff> <figcaption>Embedded Tweet Not Loading</figcaption> </figure> </div> <p>I had a look into it and realised that in these cases, the <code>blockquote</code> never got resolved, so just stayed on the page as a <code>blockquote</code> element. Below you can see what it is meant to look like vs how it looked when it wasn't working.</p> <div id=imageDiv> <figure> <img alt="Resolved Code to Display Tweet" src=https://joshlearningtocode.files.wordpress.com/2020/08/resolved-code.png> <figcaption>Resolved Code to Display Tweet</figcaption> </figure> <figure> <img alt="Unresolved Blockquote Remaining on Page" src=https://joshlearningtocode.files.wordpress.com/2020/08/unresolved-blockquote.png> <figcaption>Unresolved Blockquote Remaining on Page</figcaption> </figure> </div> <p>I had a feeling this was to do with all the complexity around JavaScript being asynchronous, and also that the way I am using Svelte and Sapper is that is uses Server Side Rendering (SSR), which can cause issues.</p> <p>To get around this, I decided it would be better to load the tweets after the page had loaded, to avoid these problems. I tried using a svelte twitter widgets plugin initially, but I was unable to get it to work. I did a bit more digging, and found <a href=https://developer.twitter.com/en/docs/twitter-for-websites/embedded-tweets/guides/embedded-tweet-javascript-factory-function target=_blank>some information from Twitter themselves</a>. Using this JavaScript factory function, it would allow you to dynamically insert tweets, which is basically what I wanted. Firsly I added this script to the <code>_layout.svelte</code> file which applied to every other file. This meant it should be available anywhere I needed it:</p> <div id=codeSnippet> <pre class=language-javascriptreact><code><span class=hljs-tag>&lt;<span class=hljs-name>script</span> <span class=hljs-attr>id</span>=<span class=hljs-string>"twitter-wjs"</span> <span class=hljs-attr>src</span>=<span class=hljs-string>"https://platform.twitter.com/widgets.js"</span>></span><span class=hljs-tag>&lt;/<span class=hljs-name>script</span>></span></code></pre></div> <p>To create the tweet using the factory, a function like the below would be needed:</p> <div id=codeSnippet> <pre class=language-javascriptreact><code>twttr.widgets.createTweet(
  <span class=hljs-string>'20'</span>, <span class=hljs-comment>// id of the tweet</span>
  <span class=hljs-built_in>document</span>.getElementById(<span class=hljs-string>'container'</span>), <span class=hljs-comment>// parent element where tweet will go</span>
  {
    <span class=hljs-attr>theme</span>: <span class=hljs-string>'dark'</span> <span class=hljs-comment>// tweet theme</span>
  }
);</code></pre></div> <p>As I now needed to only know the id of a tweet, I replaced my <code>blockquote</code> code in the markdown file, with a simple <code>p</code> tag containing the id of the tweet. I gave the tag a class of <strong><em>tweetToEmbed</em></strong> to make it easy to identify. I set the display to none so that the number does not show on the page.</p> <div id=codeSnippet> <pre class=language-javascriptreact><code><span class=hljs-tag>&lt;<span class=hljs-name>p</span> <span class=hljs-attr>class</span>=<span class=hljs-string>"tweetToEmbed"</span> <span class=hljs-attr>style</span>=<span class=hljs-string>"display: none;"</span>></span>1293525663702450176<span class=hljs-tag>&lt;/<span class=hljs-name>p</span>></span></code></pre></div> <p>Next I added a function in my <code>[slug].svelte</code> file, which is where the posts are rendered into actual pages, to use this factory function.</p> <div id=codeSnippet> <pre class=language-javascriptreact><code><span class=hljs-function><span class=hljs-keyword>function</span> <span class=hljs-title>createTweets</span>(<span class=hljs-params></span>) </span>{
  <span class=hljs-keyword>var</span> tweets = <span class=hljs-built_in>document</span>.getElementsByClassName(<span class=hljs-string>'tweetToEmbed'</span>);
  <span class=hljs-keyword>for</span> (<span class=hljs-keyword>var</span> i = <span class=hljs-number>0</span>; i &lt; tweets.length; i++) {
    <span class=hljs-keyword>var</span> tweet = tweets[i];
    <span class=hljs-keyword>var</span> parent = tweet.parentElement;
    <span class=hljs-built_in>window</span>.twttr.widgets.createTweet(
      tweet.innerText,
      parent,
      {
        <span class=hljs-attr>align</span>: <span class=hljs-string>'center'</span>,
        <span class=hljs-attr>theme</span>: <span class=hljs-string>'dark'</span>,
        <span class=hljs-attr>dnt</span>: <span class=hljs-string>'true'</span>
      }
    );
  };
}</code></pre></div> <p>Basically I am retrieving every <strong><em>tweetToEmbed</em></strong> element, and for each one I am getting the parent element and adding the tweet into it using the factory. </p> <p>It worked exactly as I wanted it to, it was rendering the tweets every time, and with minimal delay. </p> <p>I really wanted to be able to change the theme of the tweet dynamically however, as I had done with the rest of the website. I had a think, and was able to achieve this doing the below.</p> <p>First I needed to identify when the theme had changed. I knew that when it changed, a <code>dark-mode</code> class was either appended or removed from the body tag. So I Googled how I could watch for these changes, and found out about <code>MutationObserver</code>. I added this code to my JavaScript:</p> <div id=codeSnippet> <pre class=language-javascriptreact><code><span class=hljs-keyword>var</span> body = <span class=hljs-built_in>document</span>.body;
<span class=hljs-keyword>const</span> mutationObserver = <span class=hljs-keyword>new</span> MutationObserver(callback)
mutationObserver.observe(body, { <span class=hljs-attr>attributes</span>: <span class=hljs-literal>true</span> })
<span class=hljs-function><span class=hljs-keyword>function</span> <span class=hljs-title>callback</span>(<span class=hljs-params>mutationsList, observer</span>) </span>{
  mutationsList.forEach(<span class=hljs-function><span class=hljs-params>mutation</span> =></span> {
    <span class=hljs-keyword>if</span> (mutation.attributeName === <span class=hljs-string>'class'</span>) {
      <span class=hljs-comment>// do something after class has changed</span>
    };
  });
};</code></pre></div> <p>If the class of the <code>body</code> changed, this would catch it. Unfortunately it didn't seem to capture what the change was, so I couldn't tell from here what theme it was changing to. So I added another function called <code>checkTheme</code>:</p> <div id=codeSnippet> <pre class=language-javascriptreact><code><span class=hljs-function><span class=hljs-keyword>function</span> <span class=hljs-title>checkTheme</span>(<span class=hljs-params></span>) </span>{
  <span class=hljs-keyword>var</span> dark_toggle = <span class=hljs-built_in>localStorage</span>.getItem(<span class=hljs-string>'dark_mode_toggle'</span>);
  <span class=hljs-keyword>if</span> (dark_toggle === <span class=hljs-string>'false'</span>) {
    <span class=hljs-keyword>return</span> <span class=hljs-string>'light'</span>;
  } <span class=hljs-keyword>else</span> {
    <span class=hljs-keyword>return</span> <span class=hljs-string>'dark'</span>;
  };
};</code></pre></div> <p>This function made use of the localStorage item I was using to set the theme when the page first loads. Now I could tell what the theme was, I could pass this to my <code>createTweets</code> function to update the theme of the tweets. However, I would first need to delete any existing tweets, otherwise they would all just stack up as a new one would be created every time the theme was changed on the page. I added a function to deal with this too. Here is all the completed code for doing everything I just talked about:</p> <div id=codeSnippet> <pre class=language-javascriptreact><code>
<span class=hljs-comment>// listening for changes to the body class</span>
<span class=hljs-keyword>var</span> body = <span class=hljs-built_in>document</span>.body;
<span class=hljs-keyword>const</span> mutationObserver = <span class=hljs-keyword>new</span> MutationObserver(callback)
mutationObserver.observe(body, { <span class=hljs-attr>attributes</span>: <span class=hljs-literal>true</span> })
<span class=hljs-function><span class=hljs-keyword>function</span> <span class=hljs-title>callback</span>(<span class=hljs-params>mutationsList, observer</span>) </span>{
  mutationsList.forEach(<span class=hljs-function><span class=hljs-params>mutation</span> =></span> {
    <span class=hljs-keyword>if</span> (mutation.attributeName === <span class=hljs-string>'class'</span>) {
      createTweets(checkTheme()); <span class=hljs-comment>// calls createTweets with the theme which is decided by checkTheme</span>
    };
  });
};

<span class=hljs-comment>// called to figure out what the theme is currently</span>
<span class=hljs-function><span class=hljs-keyword>function</span> <span class=hljs-title>checkTheme</span>(<span class=hljs-params></span>) </span>{
  <span class=hljs-keyword>var</span> dark_toggle = <span class=hljs-built_in>localStorage</span>.getItem(<span class=hljs-string>'dark_mode_toggle'</span>);
  <span class=hljs-keyword>if</span> (dark_toggle === <span class=hljs-string>'false'</span>) {
    <span class=hljs-keyword>return</span> <span class=hljs-string>'light'</span>;
  } <span class=hljs-keyword>else</span> {
    <span class=hljs-keyword>return</span> <span class=hljs-string>'dark'</span>;
  };
};

<span class=hljs-comment>// calling the method to load the tweet when the page loads</span>
createTweets(checkTheme());

<span class=hljs-comment>// creating the tweet with a theme that is passed in</span>
<span class=hljs-function><span class=hljs-keyword>function</span> <span class=hljs-title>createTweets</span>(<span class=hljs-params>theme</span>) </span>{
  cleanupTweets(); <span class=hljs-comment>// first deletes any existing tweets on the page</span>
  <span class=hljs-keyword>var</span> tweets = <span class=hljs-built_in>document</span>.getElementsByClassName(<span class=hljs-string>'tweetToEmbed'</span>);
  <span class=hljs-keyword>for</span> (<span class=hljs-keyword>var</span> i = <span class=hljs-number>0</span>; i &lt; tweets.length; i++) {
    <span class=hljs-keyword>var</span> tweet = tweets[i];
    <span class=hljs-keyword>var</span> parent = tweet.parentElement;
    <span class=hljs-built_in>window</span>.twttr.widgets.createTweet(
      tweet.innerText,
      parent,
      {
        <span class=hljs-attr>align</span>: <span class=hljs-string>'center'</span>,
        <span class=hljs-attr>theme</span>: theme, <span class=hljs-comment>// uses whatever theme is passed in</span>
        <span class=hljs-attr>dnt</span>: <span class=hljs-string>'true'</span>
      }
    );
  };
}

<span class=hljs-comment>// finds all existing tweets and removes them from the parent node</span>
<span class=hljs-function><span class=hljs-keyword>function</span> <span class=hljs-title>cleanupTweets</span>(<span class=hljs-params></span>) </span>{
  <span class=hljs-keyword>var</span> tweets = <span class=hljs-built_in>document</span>.getElementsByClassName(<span class=hljs-string>'twitter-tweet twitter-tweet-rendered'</span>);
  <span class=hljs-keyword>while</span>(tweets.length > <span class=hljs-number>0</span>){
    tweets[<span class=hljs-number>0</span>].parentNode.removeChild(tweets[<span class=hljs-number>0</span>]);
  };
};</code></pre></div> <p>So now the tweet is able to dynamically change with the theme of the website!</p> <div id=imageDiv> <figure> <img alt="A tweet switching themes" src=https://joshlearningtocode.files.wordpress.com/2020/08/tweet-theme-changing.gif> </figure> </div> <p>You can see there is a small delay where the JavaScript is getting the tweet, but it is pretty minimal.</p> <p>I spent a couple of days fumbling around with plugins, scripts, JavaScript and all sorts trying to get this to work, so I hope that if anyone else is in this very specific situation, they are able to find this and maybe get some inspiration to help them solve their issues!</p> <p>You can have a play around with it and hopefully see it working with the tweet below:</p> <div id=imageDiv> <p class=tweetToEmbed style=display:none>1293525663702450176</p> </div> <br></div> <br> <div class=svelte-b7hd5f><a href=about><img alt=Me src="./images/about/Small Profile Pic.jpg" class="svelte-b7hd5f signature-image"></a> <h3 class=svelte-b7hd5f>Post by</h3> <a href=about><h1 class=svelte-b7hd5f>Josh Glasson</h1></a> <h3 class=svelte-b7hd5f>Software Developer. Creator and owner of this blog.</h3></div> <div id=recentPosts></div> <div id=relatedPosts></div> <div class=pswp aria-hidden=true role=dialog tabindex=-1> <div class=pswp__bg></div> <div class=pswp__scroll-wrap> <div class=pswp__container><div class=pswp__item></div> <div class=pswp__item></div> <div class=pswp__item></div></div> <div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar> <div class=pswp__counter></div> <button class="pswp__button pswp__button--close" title="Close (Esc)"></button> <button class="pswp__button pswp__button--share" title=Share></button> <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button> <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button> <div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div> <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div> <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button> <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button> <div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div></main></div> <script>__SAPPER__={baseUrl:"",preloaded:[void 0,null,(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y){return {post:{html:"\u003Cp\u003EI have embedded a few tweets in my recent blog posts, you can see examples \u003Ca href=\"https:\u002F\u002Fjoshglasson.com\u002Fblog\u002Ff1_2020_70th_anniversary_gp\" target=\"_blank\"\u003Ehere in my last F1 recap\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\n\u003Cp\u003EOriginally I was using Twitter&#39;s built in embed functionality. If you click the embed option on a tweet, you get taken to another page which provides some code for you to use. Here is an example of this code:\u003C\u002Fp\u003E\n\u003Cdiv id=\"codeSnippet\"\u003E\n\n\u003Cpre class='language-javascriptreact'\u003E\u003Ccode\u003E\u003Cspan class=\"hljs-tag\"\u003E&lt;\u003Cspan class=\"hljs-name\"\u003Eblockquote\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-attr\"\u003Eclass\u003C\u002Fspan\u003E=\u003Cspan class=\"hljs-string\"\u003E&quot;twitter-tweet&quot;\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"hljs-tag\"\u003E&lt;\u003Cspan class=\"hljs-name\"\u003Ep\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-attr\"\u003Elang\u003C\u002Fspan\u003E=\u003Cspan class=\"hljs-string\"\u003E&quot;en&quot;\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-attr\"\u003Edir\u003C\u002Fspan\u003E=\u003Cspan class=\"hljs-string\"\u003E&quot;ltr&quot;\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003EMax\u003Cspan class=\"hljs-symbol\"\u003E&amp;#39;\u003C\u002Fspan\u003Es grandma is probably pretty fast though, right?!? ðŸ‘µ ðŸš€\u003Cspan class=\"hljs-tag\"\u003E&lt;\u003Cspan class=\"hljs-name\"\u003Ea\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-attr\"\u003Ehref\u003C\u002Fspan\u003E=\u003Cspan class=\"hljs-string\"\u003E&quot;https:\u002F\u002Ftwitter.com\u002Fhashtag\u002FF170?src=hash\u003Cspan class=\"hljs-symbol\"\u003E&amp;amp;\u003C\u002Fspan\u003Eref_src=twsrc%5Etfw&quot;\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E#F170\u003Cspan class=\"hljs-tag\"\u003E&lt;\u002F\u003Cspan class=\"hljs-name\"\u003Ea\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E ðŸ‡¬ðŸ‡§ \u003Cspan class=\"hljs-tag\"\u003E&lt;\u003Cspan class=\"hljs-name\"\u003Ea\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-attr\"\u003Ehref\u003C\u002Fspan\u003E=\u003Cspan class=\"hljs-string\"\u003E&quot;https:\u002F\u002Ftwitter.com\u002Fhashtag\u002FF1?src=hash\u003Cspan class=\"hljs-symbol\"\u003E&amp;amp;\u003C\u002Fspan\u003Eref_src=twsrc%5Etfw&quot;\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E#F1\u003Cspan class=\"hljs-tag\"\u003E&lt;\u002F\u003Cspan class=\"hljs-name\"\u003Ea\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-tag\"\u003E&lt;\u003Cspan class=\"hljs-name\"\u003Ea\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-attr\"\u003Ehref\u003C\u002Fspan\u003E=\u003Cspan class=\"hljs-string\"\u003E&quot;https:\u002F\u002Ft.co\u002Fc0CpuE3iGE&quot;\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003Epic.twitter.com\u002Fc0CpuE3iGE\u003Cspan class=\"hljs-tag\"\u003E&lt;\u002F\u003Cspan class=\"hljs-name\"\u003Ea\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"hljs-tag\"\u003E&lt;\u002F\u003Cspan class=\"hljs-name\"\u003Ep\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"hljs-symbol\"\u003E&amp;mdash;\u003C\u002Fspan\u003E Formula 1 (@F1) \u003Cspan class=\"hljs-tag\"\u003E&lt;\u003Cspan class=\"hljs-name\"\u003Ea\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-attr\"\u003Ehref\u003C\u002Fspan\u003E=\u003Cspan class=\"hljs-string\"\u003E&quot;https:\u002F\u002Ftwitter.com\u002FF1\u002Fstatus\u002F1292573366981816320?ref_src=twsrc%5Etfw&quot;\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003EAugust 9, 2020\u003Cspan class=\"hljs-tag\"\u003E&lt;\u002F\u003Cspan class=\"hljs-name\"\u003Ea\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"hljs-tag\"\u003E&lt;\u002F\u003Cspan class=\"hljs-name\"\u003Eblockquote\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-tag\"\u003E&lt;\u003Cspan class=\"hljs-name\"\u003Escript\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-attr\"\u003Easync\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-attr\"\u003Esrc\u003C\u002Fspan\u003E=\u003Cspan class=\"hljs-string\"\u003E&quot;https:\u002F\u002Fplatform.twitter.com\u002Fwidgets.js&quot;\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-attr\"\u003Echarset\u003C\u002Fspan\u003E=\u003Cspan class=\"hljs-string\"\u003E&quot;utf-8&quot;\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"hljs-tag\"\u003E&lt;\u002F\u003Cspan class=\"hljs-name\"\u003Escript\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E \u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\n\u003Cdiv id=\"imageDiv\"\u003E\n  \u003Cfigure\u003E\n    \u003Cimg src=\"https:\u002F\u002Fjoshlearningtocode.files.wordpress.com\u002F2020\u002F08\u002Fscreenshot-2020-08-12-at-11.33.43.png\" alt=\"Embed option on Tweet\"\u002F\u003E\n    \u003Cfigcaption\u003EEmbed option on Tweet\u003C\u002Ffigcaption\u003E\n  \u003C\u002Ffigure\u003E\n  \u003Cfigure\u003E\n    \u003Cimg src=\"https:\u002F\u002Fjoshlearningtocode.files.wordpress.com\u002F2020\u002F08\u002Fscreenshot-2020-08-12-at-11.34.10.png\" alt=\"Twitter Embed Website\"\u002F\u003E\n    \u003Cfigcaption\u003ETwitter Embed Website\u003C\u002Ffigcaption\u003E\u003C\u002Fa\u003E\n  \u003C\u002Ffigure\u003E\n\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EI also added \u003Ccode\u003Etw-align-center\u003C\u002Fcode\u003E to make the tweet center itself in the div.\u003C\u002Fp\u003E\n\u003Cdiv id=\"imageDiv\"\u003E\n  \u003Cfigure\u003E\n    \u003Cimg src=\"https:\u002F\u002Fjoshlearningtocode.files.wordpress.com\u002F2020\u002F08\u002Fembedded-tweet.png\" style=\"border-style: solid; border-color: white;\" alt=\"Embedded Tweet\"\u002F\u003E\n    \u003Cfigcaption\u003EEmbedded Tweet\u003C\u002Ffigcaption\u003E\n  \u003C\u002Ffigure\u003E\n\u003C\u002Fdiv\u003E\n\n\n\u003Cp\u003EI thought this worked fine, I could see the tweet loading and it was visible on the page. I added \u003Ccode\u003Edata-theme: dark\u003C\u002Fcode\u003E to change the background colour of the tweet to be in dark mode too.\u003C\u002Fp\u003E\n\u003Cp\u003EThe way it seemed to work was that the script Twitter included in the embed code would resolve the \u003Ccode\u003Eblockquote\u003C\u002Fcode\u003E into a bunch of divs containing the content.\u003C\u002Fp\u003E\n\u003Cp\u003EI was happy with this, so I pushed it live. However once it was live, I was looking at it on my phone, and I noticed that most of the time the tweet would not load:\u003C\u002Fp\u003E\n\u003Cdiv id=\"imageDiv\"\u003E\n  \u003Cfigure\u003E\n    \u003Cimg src=\"https:\u002F\u002Fjoshlearningtocode.files.wordpress.com\u002F2020\u002F08\u002Fembedded-tweet-not-loading.png\" style=\"border-style: solid; border-color: white;\" alt=\"Embedded Tweet Not Loading\"\u002F\u003E\n    \u003Cfigcaption\u003EEmbedded Tweet Not Loading\u003C\u002Ffigcaption\u003E\n  \u003C\u002Ffigure\u003E\n\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EI had a look into it and realised that in these cases, the \u003Ccode\u003Eblockquote\u003C\u002Fcode\u003E never got resolved, so just stayed on the page as a \u003Ccode\u003Eblockquote\u003C\u002Fcode\u003E element. Below you can see what it is meant to look like vs how it looked when it wasn&#39;t working.\u003C\u002Fp\u003E\n\u003Cdiv id=\"imageDiv\"\u003E\n  \u003Cfigure\u003E\n    \u003Cimg src=\"https:\u002F\u002Fjoshlearningtocode.files.wordpress.com\u002F2020\u002F08\u002Fresolved-code.png\" alt=\"Resolved Code to Display Tweet\"\u002F\u003E\n    \u003Cfigcaption\u003EResolved Code to Display Tweet\u003C\u002Ffigcaption\u003E\n  \u003C\u002Ffigure\u003E\n  \u003Cfigure\u003E\n    \u003Cimg src=\"https:\u002F\u002Fjoshlearningtocode.files.wordpress.com\u002F2020\u002F08\u002Funresolved-blockquote.png\" alt=\"Unresolved Blockquote Remaining on Page\"\u002F\u003E\n    \u003Cfigcaption\u003EUnresolved Blockquote Remaining on Page\u003C\u002Ffigcaption\u003E\u003C\u002Fa\u003E\n  \u003C\u002Ffigure\u003E\n\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EI had a feeling this was to do with all the complexity around JavaScript being asynchronous, and also that the way I am using Svelte and Sapper is that is uses Server Side Rendering (SSR), which can cause issues.\u003C\u002Fp\u003E\n\u003Cp\u003ETo get around this, I decided it would be better to load the tweets after the page had loaded, to avoid these problems. I tried using a svelte twitter widgets plugin initially, but I was unable to get it to work. I did a bit more digging, and found \u003Ca href=\"https:\u002F\u002Fdeveloper.twitter.com\u002Fen\u002Fdocs\u002Ftwitter-for-websites\u002Fembedded-tweets\u002Fguides\u002Fembedded-tweet-javascript-factory-function\" target=\"_blank\"\u003Esome information from Twitter themselves\u003C\u002Fa\u003E. Using this JavaScript factory function, it would allow you to dynamically insert tweets, which is basically what I wanted. Firsly I added this script to the \u003Ccode\u003E_layout.svelte\u003C\u002Fcode\u003E file which applied to every other file. This meant it should be available anywhere I needed it:\u003C\u002Fp\u003E\n\u003Cdiv id=\"codeSnippet\"\u003E\n\n\u003Cpre class='language-javascriptreact'\u003E\u003Ccode\u003E\u003Cspan class=\"hljs-tag\"\u003E&lt;\u003Cspan class=\"hljs-name\"\u003Escript\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-attr\"\u003Eid\u003C\u002Fspan\u003E=\u003Cspan class=\"hljs-string\"\u003E&quot;twitter-wjs&quot;\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-attr\"\u003Esrc\u003C\u002Fspan\u003E=\u003Cspan class=\"hljs-string\"\u003E&quot;https:\u002F\u002Fplatform.twitter.com\u002Fwidgets.js&quot;\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"hljs-tag\"\u003E&lt;\u002F\u003Cspan class=\"hljs-name\"\u003Escript\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\n\u003Cp\u003ETo create the tweet using the factory, a function like the below would be needed:\u003C\u002Fp\u003E\n\u003Cdiv id=\"codeSnippet\"\u003E\n\n\u003Cpre class='language-javascriptreact'\u003E\u003Ccode\u003Etwttr.widgets.createTweet(\n  \u003Cspan class=\"hljs-string\"\u003E&#x27;20&#x27;\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F id of the tweet\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-built_in\"\u003Edocument\u003C\u002Fspan\u003E.getElementById(\u003Cspan class=\"hljs-string\"\u003E&#x27;container&#x27;\u003C\u002Fspan\u003E), \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F parent element where tweet will go\u003C\u002Fspan\u003E\n  {\n    \u003Cspan class=\"hljs-attr\"\u003Etheme\u003C\u002Fspan\u003E: \u003Cspan class=\"hljs-string\"\u003E&#x27;dark&#x27;\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F tweet theme\u003C\u002Fspan\u003E\n  }\n);\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EAs I now needed to only know the id of a tweet, I replaced my \u003Ccode\u003Eblockquote\u003C\u002Fcode\u003E code in the markdown file, with a simple \u003Ccode\u003Ep\u003C\u002Fcode\u003E tag containing the id of the tweet. I gave the tag a class of \u003Cstrong\u003E\u003Cem\u003EtweetToEmbed\u003C\u002Fem\u003E\u003C\u002Fstrong\u003E to make it easy to identify. I set the display to none so that the number does not show on the page.\u003C\u002Fp\u003E\n\u003Cdiv id=\"codeSnippet\"\u003E\n\n\u003Cpre class='language-javascriptreact'\u003E\u003Ccode\u003E\u003Cspan class=\"hljs-tag\"\u003E&lt;\u003Cspan class=\"hljs-name\"\u003Ep\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-attr\"\u003Eclass\u003C\u002Fspan\u003E=\u003Cspan class=\"hljs-string\"\u003E&quot;tweetToEmbed&quot;\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-attr\"\u003Estyle\u003C\u002Fspan\u003E=\u003Cspan class=\"hljs-string\"\u003E&quot;display: none;&quot;\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E1293525663702450176\u003Cspan class=\"hljs-tag\"\u003E&lt;\u002F\u003Cspan class=\"hljs-name\"\u003Ep\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\n\u003Cp\u003ENext I added a function in my \u003Ccode\u003E[slug].svelte\u003C\u002Fcode\u003E file, which is where the posts are rendered into actual pages, to use this factory function.\u003C\u002Fp\u003E\n\u003Cdiv id=\"codeSnippet\"\u003E\n\n\u003Cpre class='language-javascriptreact'\u003E\u003Ccode\u003E\u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Efunction\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003EcreateTweets\u003C\u002Fspan\u003E(\u003Cspan class=\"hljs-params\"\u003E\u003C\u002Fspan\u003E) \u003C\u002Fspan\u003E{\n  \u003Cspan class=\"hljs-keyword\"\u003Evar\u003C\u002Fspan\u003E tweets = \u003Cspan class=\"hljs-built_in\"\u003Edocument\u003C\u002Fspan\u003E.getElementsByClassName(\u003Cspan class=\"hljs-string\"\u003E&#x27;tweetToEmbed&#x27;\u003C\u002Fspan\u003E);\n  \u003Cspan class=\"hljs-keyword\"\u003Efor\u003C\u002Fspan\u003E (\u003Cspan class=\"hljs-keyword\"\u003Evar\u003C\u002Fspan\u003E i = \u003Cspan class=\"hljs-number\"\u003E0\u003C\u002Fspan\u003E; i &lt; tweets.length; i++) {\n    \u003Cspan class=\"hljs-keyword\"\u003Evar\u003C\u002Fspan\u003E tweet = tweets[i];\n    \u003Cspan class=\"hljs-keyword\"\u003Evar\u003C\u002Fspan\u003E parent = tweet.parentElement;\n    \u003Cspan class=\"hljs-built_in\"\u003Ewindow\u003C\u002Fspan\u003E.twttr.widgets.createTweet(\n      tweet.innerText,\n      parent,\n      {\n        \u003Cspan class=\"hljs-attr\"\u003Ealign\u003C\u002Fspan\u003E: \u003Cspan class=\"hljs-string\"\u003E&#x27;center&#x27;\u003C\u002Fspan\u003E,\n        \u003Cspan class=\"hljs-attr\"\u003Etheme\u003C\u002Fspan\u003E: \u003Cspan class=\"hljs-string\"\u003E&#x27;dark&#x27;\u003C\u002Fspan\u003E,\n        \u003Cspan class=\"hljs-attr\"\u003Ednt\u003C\u002Fspan\u003E: \u003Cspan class=\"hljs-string\"\u003E&#x27;true&#x27;\u003C\u002Fspan\u003E\n      }\n    );\n  };\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EBasically I am retrieving every \u003Cstrong\u003E\u003Cem\u003EtweetToEmbed\u003C\u002Fem\u003E\u003C\u002Fstrong\u003E element, and for each one I am getting the parent element and adding the tweet into it using the factory. \u003C\u002Fp\u003E\n\u003Cp\u003EIt worked exactly as I wanted it to, it was rendering the tweets every time, and with minimal delay. \u003C\u002Fp\u003E\n\u003Cp\u003EI really wanted to be able to change the theme of the tweet dynamically however, as I had done with the rest of the website. I had a think, and was able to achieve this doing the below.\u003C\u002Fp\u003E\n\u003Cp\u003EFirst I needed to identify when the theme had changed. I knew that when it changed, a \u003Ccode\u003Edark-mode\u003C\u002Fcode\u003E class was either appended or removed from the body tag. So I Googled how I could watch for these changes, and found out about \u003Ccode\u003EMutationObserver\u003C\u002Fcode\u003E. I added this code to my JavaScript:\u003C\u002Fp\u003E\n\u003Cdiv id=\"codeSnippet\"\u003E\n\n\u003Cpre class='language-javascriptreact'\u003E\u003Ccode\u003E\u003Cspan class=\"hljs-keyword\"\u003Evar\u003C\u002Fspan\u003E body = \u003Cspan class=\"hljs-built_in\"\u003Edocument\u003C\u002Fspan\u003E.body;\n\u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E mutationObserver = \u003Cspan class=\"hljs-keyword\"\u003Enew\u003C\u002Fspan\u003E MutationObserver(callback)\nmutationObserver.observe(body, { \u003Cspan class=\"hljs-attr\"\u003Eattributes\u003C\u002Fspan\u003E: \u003Cspan class=\"hljs-literal\"\u003Etrue\u003C\u002Fspan\u003E })\n\u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Efunction\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003Ecallback\u003C\u002Fspan\u003E(\u003Cspan class=\"hljs-params\"\u003EmutationsList, observer\u003C\u002Fspan\u003E) \u003C\u002Fspan\u003E{\n  mutationsList.forEach(\u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-params\"\u003Emutation\u003C\u002Fspan\u003E =&gt;\u003C\u002Fspan\u003E {\n    \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (mutation.attributeName === \u003Cspan class=\"hljs-string\"\u003E&#x27;class&#x27;\u003C\u002Fspan\u003E) {\n      \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F do something after class has changed\u003C\u002Fspan\u003E\n    };\n  });\n};\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EIf the class of the \u003Ccode\u003Ebody\u003C\u002Fcode\u003E changed, this would catch it. Unfortunately it didn&#39;t seem to capture what the change was, so I couldn&#39;t tell from here what theme it was changing to. So I added another function called \u003Ccode\u003EcheckTheme\u003C\u002Fcode\u003E:\u003C\u002Fp\u003E\n\u003Cdiv id=\"codeSnippet\"\u003E\n\n\u003Cpre class='language-javascriptreact'\u003E\u003Ccode\u003E\u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Efunction\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003EcheckTheme\u003C\u002Fspan\u003E(\u003Cspan class=\"hljs-params\"\u003E\u003C\u002Fspan\u003E) \u003C\u002Fspan\u003E{\n  \u003Cspan class=\"hljs-keyword\"\u003Evar\u003C\u002Fspan\u003E dark_toggle = \u003Cspan class=\"hljs-built_in\"\u003ElocalStorage\u003C\u002Fspan\u003E.getItem(\u003Cspan class=\"hljs-string\"\u003E&#x27;dark_mode_toggle&#x27;\u003C\u002Fspan\u003E);\n  \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (dark_toggle === \u003Cspan class=\"hljs-string\"\u003E&#x27;false&#x27;\u003C\u002Fspan\u003E) {\n    \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-string\"\u003E&#x27;light&#x27;\u003C\u002Fspan\u003E;\n  } \u003Cspan class=\"hljs-keyword\"\u003Eelse\u003C\u002Fspan\u003E {\n    \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-string\"\u003E&#x27;dark&#x27;\u003C\u002Fspan\u003E;\n  };\n};\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EThis function made use of the localStorage item I was using to set the theme when the page first loads. Now I could tell what the theme was, I could pass this to my \u003Ccode\u003EcreateTweets\u003C\u002Fcode\u003E function to update the theme of the tweets. However, I would first need to delete any existing tweets, otherwise they would all just stack up as a new one would be created every time the theme was changed on the page. I added a function to deal with this too. Here is all the completed code for doing everything I just talked about:\u003C\u002Fp\u003E\n\u003Cdiv id=\"codeSnippet\"\u003E\n\n\u003Cpre class='language-javascriptreact'\u003E\u003Ccode\u003E\n\u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F listening for changes to the body class\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-keyword\"\u003Evar\u003C\u002Fspan\u003E body = \u003Cspan class=\"hljs-built_in\"\u003Edocument\u003C\u002Fspan\u003E.body;\n\u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E mutationObserver = \u003Cspan class=\"hljs-keyword\"\u003Enew\u003C\u002Fspan\u003E MutationObserver(callback)\nmutationObserver.observe(body, { \u003Cspan class=\"hljs-attr\"\u003Eattributes\u003C\u002Fspan\u003E: \u003Cspan class=\"hljs-literal\"\u003Etrue\u003C\u002Fspan\u003E })\n\u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Efunction\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003Ecallback\u003C\u002Fspan\u003E(\u003Cspan class=\"hljs-params\"\u003EmutationsList, observer\u003C\u002Fspan\u003E) \u003C\u002Fspan\u003E{\n  mutationsList.forEach(\u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-params\"\u003Emutation\u003C\u002Fspan\u003E =&gt;\u003C\u002Fspan\u003E {\n    \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (mutation.attributeName === \u003Cspan class=\"hljs-string\"\u003E&#x27;class&#x27;\u003C\u002Fspan\u003E) {\n      createTweets(checkTheme()); \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F calls createTweets with the theme which is decided by checkTheme\u003C\u002Fspan\u003E\n    };\n  });\n};\n\n\u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F called to figure out what the theme is currently\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Efunction\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003EcheckTheme\u003C\u002Fspan\u003E(\u003Cspan class=\"hljs-params\"\u003E\u003C\u002Fspan\u003E) \u003C\u002Fspan\u003E{\n  \u003Cspan class=\"hljs-keyword\"\u003Evar\u003C\u002Fspan\u003E dark_toggle = \u003Cspan class=\"hljs-built_in\"\u003ElocalStorage\u003C\u002Fspan\u003E.getItem(\u003Cspan class=\"hljs-string\"\u003E&#x27;dark_mode_toggle&#x27;\u003C\u002Fspan\u003E);\n  \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (dark_toggle === \u003Cspan class=\"hljs-string\"\u003E&#x27;false&#x27;\u003C\u002Fspan\u003E) {\n    \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-string\"\u003E&#x27;light&#x27;\u003C\u002Fspan\u003E;\n  } \u003Cspan class=\"hljs-keyword\"\u003Eelse\u003C\u002Fspan\u003E {\n    \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-string\"\u003E&#x27;dark&#x27;\u003C\u002Fspan\u003E;\n  };\n};\n\n\u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F calling the method to load the tweet when the page loads\u003C\u002Fspan\u003E\ncreateTweets(checkTheme());\n\n\u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F creating the tweet with a theme that is passed in\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Efunction\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003EcreateTweets\u003C\u002Fspan\u003E(\u003Cspan class=\"hljs-params\"\u003Etheme\u003C\u002Fspan\u003E) \u003C\u002Fspan\u003E{\n  cleanupTweets(); \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F first deletes any existing tweets on the page\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-keyword\"\u003Evar\u003C\u002Fspan\u003E tweets = \u003Cspan class=\"hljs-built_in\"\u003Edocument\u003C\u002Fspan\u003E.getElementsByClassName(\u003Cspan class=\"hljs-string\"\u003E&#x27;tweetToEmbed&#x27;\u003C\u002Fspan\u003E);\n  \u003Cspan class=\"hljs-keyword\"\u003Efor\u003C\u002Fspan\u003E (\u003Cspan class=\"hljs-keyword\"\u003Evar\u003C\u002Fspan\u003E i = \u003Cspan class=\"hljs-number\"\u003E0\u003C\u002Fspan\u003E; i &lt; tweets.length; i++) {\n    \u003Cspan class=\"hljs-keyword\"\u003Evar\u003C\u002Fspan\u003E tweet = tweets[i];\n    \u003Cspan class=\"hljs-keyword\"\u003Evar\u003C\u002Fspan\u003E parent = tweet.parentElement;\n    \u003Cspan class=\"hljs-built_in\"\u003Ewindow\u003C\u002Fspan\u003E.twttr.widgets.createTweet(\n      tweet.innerText,\n      parent,\n      {\n        \u003Cspan class=\"hljs-attr\"\u003Ealign\u003C\u002Fspan\u003E: \u003Cspan class=\"hljs-string\"\u003E&#x27;center&#x27;\u003C\u002Fspan\u003E,\n        \u003Cspan class=\"hljs-attr\"\u003Etheme\u003C\u002Fspan\u003E: theme, \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F uses whatever theme is passed in\u003C\u002Fspan\u003E\n        \u003Cspan class=\"hljs-attr\"\u003Ednt\u003C\u002Fspan\u003E: \u003Cspan class=\"hljs-string\"\u003E&#x27;true&#x27;\u003C\u002Fspan\u003E\n      }\n    );\n  };\n}\n\n\u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F finds all existing tweets and removes them from the parent node\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Efunction\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003EcleanupTweets\u003C\u002Fspan\u003E(\u003Cspan class=\"hljs-params\"\u003E\u003C\u002Fspan\u003E) \u003C\u002Fspan\u003E{\n  \u003Cspan class=\"hljs-keyword\"\u003Evar\u003C\u002Fspan\u003E tweets = \u003Cspan class=\"hljs-built_in\"\u003Edocument\u003C\u002Fspan\u003E.getElementsByClassName(\u003Cspan class=\"hljs-string\"\u003E&#x27;twitter-tweet twitter-tweet-rendered&#x27;\u003C\u002Fspan\u003E);\n  \u003Cspan class=\"hljs-keyword\"\u003Ewhile\u003C\u002Fspan\u003E(tweets.length &gt; \u003Cspan class=\"hljs-number\"\u003E0\u003C\u002Fspan\u003E){\n    tweets[\u003Cspan class=\"hljs-number\"\u003E0\u003C\u002Fspan\u003E].parentNode.removeChild(tweets[\u003Cspan class=\"hljs-number\"\u003E0\u003C\u002Fspan\u003E]);\n  };\n};\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\n\u003Cp\u003ESo now the tweet is able to dynamically change with the theme of the website!\u003C\u002Fp\u003E\n\u003Cdiv id=\"imageDiv\"\u003E\n  \u003Cfigure\u003E\n    \u003Cimg src=\"https:\u002F\u002Fjoshlearningtocode.files.wordpress.com\u002F2020\u002F08\u002Ftweet-theme-changing.gif\" alt=\"A tweet switching themes\"\u002F\u003E\n  \u003C\u002Ffigure\u003E\n\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EYou can see there is a small delay where the JavaScript is getting the tweet, but it is pretty minimal.\u003C\u002Fp\u003E\n\u003Cp\u003EI spent a couple of days fumbling around with plugins, scripts, JavaScript and all sorts trying to get this to work, so I hope that if anyone else is in this very specific situation, they are able to find this and maybe get some inspiration to help them solve their issues!\u003C\u002Fp\u003E\n\u003Cp\u003EYou can have a play around with it and hopefully see it working with the tweet below:\u003C\u002Fp\u003E\n\u003Cdiv id=\"imageDiv\"\u003E\n    \u003Cp class=\"tweetToEmbed\" style=\"display: none;\"\u003E1293525663702450176\u003C\u002Fp\u003E\n\u003C\u002Fdiv\u003E\n\n\u003Cbr \u003E",slug:h,title:i,headline:j,image:k,sortdate:d,originaldate:d,tags:[a,e,f]},posts:{posts:[{slug:"2021-02-02-system_design_interview_pt3",title:"System Design Part 3.",headline:"Even More Prep for the System Design Interview",image:l,sortdate:m,originaldate:m,tags:[a]},{slug:"2021-01-19-system_design_interview_pt2",title:"System Design Part 2.",headline:"More Prep for the System Design Interview",image:l,sortdate:n,originaldate:n,tags:[a]},{slug:"2021-01-15-android_terminal",title:"Terminal on Android.",headline:"Using the Terminal on my Phone",image:".\u002Fimages\u002Ficons\u002Ftermux.jpg",sortdate:o,originaldate:o,tags:[a]},{slug:"2020-09-27-f1_2020_russian_gp",title:"F1 Recap - Russian Grand Prix 2020.",headline:"Hamilton Thwarted by Penalties Again",image:b,sortdate:p,originaldate:p,tags:[c]},{slug:"2020-09-13-f1_2020_tuscan_gp",title:"F1 Recap - Tuscan Grand Prix 2020.",headline:"2 Red Flags on Another Crazy Day in Italy",image:b,sortdate:q,originaldate:q,tags:[c]},{slug:"2020-09-06-f1_2020_italian_gp",title:"F1 Recap - Italian Grand Prix 2020.",headline:"Gasly gets his first race win",image:b,sortdate:r,originaldate:r,tags:[c]},{slug:"2020-09-03-super_mario_35th_anniversary_direct",title:"Super Mario Bros. 35th Anniversary Nintendo Direct.",headline:"All the announcements from the special Nintendo Direct",image:".\u002Fimages\u002Ficons\u002FSMB 35.png",sortdate:g,originaldate:g,tags:["Gaming"]},{slug:"2020-09-02-discord_bot",title:"Creating a Simple Discord Bot.",headline:"Its not self promotion if its done by a robot!",image:".\u002Fimages\u002Ficons\u002Fdiscord logo.png",sortdate:g,originaldate:"2020-09-02",tags:[a]},{slug:"2020-08-30-f1_2020_belgian_gp",title:"F1 Recap - Belgian Grand Prix 2020.",headline:"Daniel Ricciardo puts in a great performance to finish 4th",image:b,sortdate:s,originaldate:s,tags:[c]},{slug:"2020-08-16-f1_2020_spanish_gp",title:"F1 Recap - Spanish Grand Prix 2020.",headline:"Another dominant performance from Lewis Hamilton",image:b,sortdate:t,originaldate:t,tags:[c]},{slug:h,title:i,headline:j,image:k,sortdate:d,originaldate:d,tags:[a,e,f]},{slug:"2020-08-09-f1_2020_70th_anniversary_gp",title:"F1 Recap - 70th Anniversary Grand Prix 2020.",headline:"Brilliant strategy leads to Red Bull win",image:b,sortdate:u,originaldate:u,tags:[c]},{slug:"2020-08-07-kanye_west_albums_ranked",title:"Ranking Every Kanye West Album.",headline:"My ranking of all of Kanye West's released albums",image:".\u002Fimages\u002Ficons\u002Fkanye bear.png",sortdate:v,originaldate:v,tags:["Music"]},{slug:"2020-08-03-f1_2020_silverstone",title:"F1 Recap - Silverstone 2020.",headline:"Hamilton hangs on to victory",image:b,sortdate:w,originaldate:w,tags:[c]},{slug:"2020-07-30-useful_tools",title:"Useful Tools.",headline:"Tools I find useful as a Software Dev",image:".\u002Fimages\u002Ficons\u002Ftools.png",sortdate:"2020-07-31",originaldate:"2020-07-30",tags:[a]},{slug:"2020-07-24-creating_the_blog",title:"Creating This Blog.",headline:"How to create a blog using Svelte",image:".\u002Fimages\u002Ficons\u002Fsvelte logo.png",sortdate:x,originaldate:x,tags:[a,e,f]},{slug:"2020-07-23-test_blog",title:"Test Blog.",headline:"Testing out the blog and some features",image:".\u002Flogo.png",sortdate:y,originaldate:y,tags:[]}]}}}("Software Development",".\u002Fimages\u002Ficons\u002Ff1 logo 2020.png","Formula 1","2020-08-12","Svelte","HTML, CSS & JavaScript","2020-09-03","2020-08-12-embedding_tweets","Embedding Tweets In Svelte Blog Posts.","Reliably embed tweets in blog posts when using Svelte and Sapper",".\u002Fimages\u002Fabout\u002Ftwitter_logo.png",".\u002Fimages\u002Ficons\u002Fsystem-design.jpg","2021-02-02","2021-01-19","2021-01-15","2020-09-27","2020-09-13","2020-09-06","2020-08-30","2020-08-16","2020-08-09","2020-08-07","2020-08-03","2020-07-24","2020-07-23"))]};if('serviceWorker' in navigator)navigator.serviceWorker.register('/service-worker.js');var s=document.createElement("script");try{new Function("if(0)import('')")();s.src="/client/client.3519f8c0.js";s.type="module";s.crossOrigin="use-credentials";}catch(e){s.src="/client/shimport@1.0.1.js";s.setAttribute("data-main","/client/client.3519f8c0.js")}document.head.appendChild(s)</script> 